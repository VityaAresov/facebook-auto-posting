<!DOCTYPE html>
<html style="height: 100%">
  <head>
    <meta charset="UTF-8" />
    <link
      rel="stylesheet"
      href="https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/css/bootstrap.min.css"
    />
    <link rel="stylesheet" href="popup.css" />
    <link rel="stylesheet" href="css/quill.snow.css" />
    <link
      href="https://fonts.googleapis.com/css2?family=Inter:wght@100;400;500&display=swap"
      rel="stylesheet"
    />
    <link
      rel="stylesheet"
      href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css"
    />
    <!-- 1. Load i18n Helper FIRST -->
    <script src="i18n.js"></script>
  </head>
  <body>
    <div id="initial-loading-overlay">
      <div class="loading-spinner-container">
        <div class="loading-spinner"></div>
        <img src="./assets/icons/logo.png" class="spinner-logo" alt="Logo" />
      </div>
      <p class="loading-text" data-i18n="initLoading">
        Initializing Auto Poster...
      </p>
    </div>
    <div id="activationPage" class=""></div>

    <div class="LoadingDiv d-none">
      <div class="loading-overlay-content">
        <div class="loading-container-notify">
          <p data-i18n="loadingNotify">
            Posting has started! You can browse other tabs - we'll continue in
            the background.
          </p>
        </div>

        <div class="loading-container">
          <div class="loading-visual">
            <div class="pulse-container">
              <div class="pulse-circle pulse-circle-1"></div>
              <div class="pulse-circle pulse-circle-2"></div>
              <div class="pulse-circle pulse-circle-3"></div>
            </div>
          </div>

          <div class="loading-message-container">
            <p
              class="loading-message"
              id="LoadingContent"
              data-i18n="loadingMsg"
            >
              Preparing to post...
            </p>
          </div>

          <div id="liveLogContainer" class="live-log-container"></div>

          <button
            type="button"
            id="stopButton"
            class="btn-visual-danger loading-page-stop-button"
          >
            <i class="fa fa-stop-circle" aria-hidden="true"></i>
            <span class="stop-text" data-i18n="btnStop">Stop Posting</span>
          </button>

          <div
            class="mt-2 text-center"
            id="stuckProcessReset"
            style="display: none"
          >
            <small class="text-muted" data-i18n="stuckReset"
              >Posting stuck? - only in case of issues.</small
            >
            <button
              id="forceResetStatusBtn"
              class="btn btn-sm btn-warning ml-2"
              data-i18n="btnForceReset"
            >
              Force Reset
            </button>
          </div>
        </div>
      </div>
    </div>

    <div class="LogsDiv d-none">
      <span id="CloseLogButton" class="remove-icon close2">&#215;</span>

      <img
        class="icon1"
        src="./assets/icons/larger-logo-extension.png"
        alt=""
      />
      <p class="loadingText" id="LoadingContent" data-i18n="postingCompleted">
        Posting completed!
      </p>
      <ul class="logsUL"></ul>
    </div>

    <div id="hiddenPage" class="container hidden-layer d-none">
      <div class="row justify-content-center">
        <div class="col-md-8">
          <div class="card">
            <div
              class="card-header d-flex justify-content-between align-items-center"
            >
              <h5 class="mb-0" data-i18n="aboutTitle">About</h5>
              <span id="versionInfo"></span>
            </div>
            <div class="card-body">
              <form>
                <div class="form-group row gap0">
                  <label for="languageSelect" class="col-sm-4 col-form-label"
                    >Language:</label
                  >
                  <div class="col-sm-8">
                    <select id="languageSelect" class="form-control">
                      <option value="default">System Default</option>
                      <option value="en">English</option>
                      <option value="de">Deutsch (German)</option>
                      <option value="es">Español (Spanish)</option>
                      <option value="fr">Français (French)</option>
                      <option value="pt">Português (Portuguese)</option>
                      <option value="hu">Magyar (Hungarian)</option>
                    </select>
                  </div>
                </div>
                <div class="telemetry-form-group">
                  <div class="telemetry-main-row">
                    <label
                      for="allowTelemetryToggle"
                      class="telemetry-label"
                      data-i18n="lblTelemetry"
                      >Allow Anonymous Usage Data</label
                    >
                    <div class="toggle-switch">
                      <input
                        type="checkbox"
                        id="allowTelemetryToggle"
                        class="toggle-input"
                        checked
                      />
                      <label
                        for="allowTelemetryToggle"
                        class="toggle-label"
                      ></label>
                    </div>
                  </div>
                  <small class="telemetry-description" data-i18n="descTelemetry"
                    >This helps us improve the extension. We never collect
                    personal data or content.</small
                  >
                </div>
                <div
                  class="telemetry-form-group"
                  style="border-top: none; margin-top: 0; padding-top: 0"
                >
                  <div class="telemetry-main-row">
                    <label
                      for="skipNetworkCheckToggle"
                      class="telemetry-label"
                      data-i18n="lblSkipNet"
                      >Disable Connectivity Check</label
                    >
                    <div class="toggle-switch">
                      <input
                        type="checkbox"
                        id="skipNetworkCheckToggle"
                        class="toggle-input"
                      />
                      <label
                        for="skipNetworkCheckToggle"
                        class="toggle-label"
                      ></label>
                    </div>
                  </div>
                  <small class="telemetry-description" data-i18n="descSkipNet"
                    >Enable this only if your posts get stuck on "Connection
                    unstable" despite having working internet.</small
                  >
                </div>
                <div class="form-section mt-3">
                  <h6
                    class="section-subtitle mb-3"
                    style="color: #4b5563"
                    data-i18n="secBackup"
                  >
                    Backup & Restore
                  </h6>
                  <div class="d-flex" style="gap: 10px">
                    <button
                      type="button"
                      id="backupDataBtn"
                      class="btn-visual-secondary"
                      style="flex: 1"
                    >
                      <i class="fa fa-download mr-1"></i>
                      <span data-i18n="btnBackup">Backup All Data</span>
                    </button>
                    <button
                      type="button"
                      id="restoreDataBtn"
                      class="btn-visual-secondary"
                      style="flex: 1"
                    >
                      <i class="fa fa-upload mr-1"></i>
                      <span data-i18n="btnRestore">Restore from Backup</span>
                    </button>
                  </div>
                  <small
                    class="form-hint text-center mt-2"
                    data-i18n="descBackup"
                    >Saves templates and group collections (no media).</small
                  >
                  <input
                    type="file"
                    id="restoreDataInput"
                    accept=".json"
                    style="display: none"
                  />
                </div>

                <div class="form-section mt-3">
                  <h6 class="section-subtitle mb-3" style="color: #4b5563">
                    API Bridge
                  </h6>

                  <div class="telemetry-form-group">
                    <div class="telemetry-main-row">
                      <label for="bridgeEnabledToggle" class="telemetry-label"
                        >Enable API Bridge</label
                      >
                      <div class="toggle-switch">
                        <input
                          type="checkbox"
                          id="bridgeEnabledToggle"
                          class="toggle-input"
                        />
                        <label
                          for="bridgeEnabledToggle"
                          class="toggle-label"
                        ></label>
                      </div>
                    </div>
                    <small class="telemetry-description"
                      >Allow local automation tools (n8n/Make) to control the
                      extension.</small
                    >
                  </div>

                  <div class="form-group row gap0">
                    <label for="bridgeBaseUrl" class="col-sm-4 col-form-label"
                      >Base URL:</label
                    >
                    <div class="col-sm-8">
                      <input
                        type="text"
                        class="form-control"
                        id="bridgeBaseUrl"
                        placeholder="http://127.0.0.1:3721"
                      />
                    </div>
                  </div>

                  <div class="form-group row gap0">
                    <label for="bridgeApiKey" class="col-sm-4 col-form-label"
                      >API Key:</label
                    >
                    <div class="col-sm-8">
                      <input
                        type="password"
                        class="form-control"
                        id="bridgeApiKey"
                        placeholder="YOUR_KEY"
                      />
                    </div>
                  </div>

                  <div class="form-group row gap0">
                    <label for="bridgePollInterval" class="col-sm-4 col-form-label"
                      >Poll (ms):</label
                    >
                    <div class="col-sm-8">
                      <input
                        type="number"
                        class="form-control"
                        id="bridgePollInterval"
                        min="1000"
                        step="500"
                        placeholder="5000"
                      />
                    </div>
                  </div>

                  <div class="d-flex" style="gap: 10px">
                    <button
                      type="button"
                      id="bridgeSaveBtn"
                      class="btn-visual-secondary"
                      style="flex: 1"
                    >
                      Save API Settings
                    </button>
                    <button
                      type="button"
                      id="bridgeTestBtn"
                      class="btn-visual-secondary"
                      style="flex: 1"
                    >
                      Test Connection
                    </button>
                  </div>
                  <small class="form-hint text-center mt-2" id="bridgeStatusText"
                    >Status: Not tested</small
                  >
                </div>

              </form>
            </div>
            <div class="card-footer text-center">
              <button
                type="button"
                id="backButton"
                class="btn-visual-secondary"
                data-i18n="btnBack"
              >
                Back
              </button>
              <a
                href="#"
                target="_blank"
                class="btn-visual-secondary"
                data-i18n="btnFeatureReq"
                >Feature request</a
              >
            </div>
          </div>
        </div>
      </div>
    </div>

    <div id="main" class="mainContainer d-none">
      <div class="container" id="Tags">
        <div class="justify-content-center" style="margin-bottom: 10px">
          <div class="top-bar-actions">
            <div style="flex-grow: 1"></div>

            <div id="aboutButton" class="help-badge">
              <span data-i18n="menuAbout">About</span>
            </div>
            <div id="helpBadge" class="help-badge">
              <span data-i18n="menuHelp">Help</span>
            </div>

            <button class="close-icon" id="closePopup">
              <i class="fa fa-times" aria-hidden="true"></i>
            </button>
          </div>

          <div style="text-align: center; margin: 5px 0 5px 0">
            <img
              id="logo"
              style="height: 70px; width: 70px; object-fit: contain"
              src="./assets/icons/logo.png"
              alt="Auto Poster Logo"
            />
          </div>
        </div>

        <div id="onboardingChecklist" class="onboarding-card d-none">
          <div class="onboarding-header" id="checklistHeader">
            <div class="d-flex align-items-center gap-2">
              <div
                class="progress-ring"
                id="checklistRing"
                style="--percent: 0%"
              >
                <div class="progress-inner" id="checklistPercent">0%</div>
              </div>
              <span class="onboarding-title" data-i18n="guideTitle"
                >Setup Guide</span
              >
            </div>
            <i class="fa fa-chevron-down text-muted"></i>
          </div>

          <div class="onboarding-body open" id="checklistBody">
            <div class="checklist-item" id="step-extract">
              <div class="check-circle"><i class="fa fa-check"></i></div>
              <div class="checklist-text">
                <div class="checklist-title" data-i18n="stepImport">
                  Import Groups
                </div>
                <span class="checklist-desc" data-i18n="descImport"
                  >Extract your Facebook groups.</span
                >
              </div>
              <div
                class="checklist-action"
                data-action="extract"
                data-i18n="btnGo"
              >
                Go
              </div>
            </div>

            <div class="checklist-item" id="step-template">
              <div class="check-circle"><i class="fa fa-check"></i></div>
              <div class="checklist-text">
                <div class="checklist-title" data-i18n="stepTemplate">
                  Create Template
                </div>
                <span class="checklist-desc" data-i18n="descTemplate"
                  >Write a reusable post.</span
                >
              </div>
              <div
                class="checklist-action"
                data-action="template"
                data-i18n="btnGo"
              >
                Go
              </div>
            </div>

            <div class="checklist-item" id="step-variations">
              <div class="check-circle"><i class="fa fa-check"></i></div>
              <div class="checklist-text">
                <div class="checklist-title" data-i18n="stepVars">
                  Add Variations
                </div>
                <span class="checklist-desc" data-i18n="descVars"
                  >Use {Hi|Hello} or Tabs to vary text.</span
                >
              </div>
              <div
                class="checklist-action"
                data-action="template"
                data-i18n="btnGo"
              >
                Go
              </div>
            </div>

            <div class="checklist-item" id="step-post">
              <div class="check-circle"><i class="fa fa-check"></i></div>
              <div class="checklist-text">
                <div class="checklist-title" data-i18n="stepPost">
                  Send a Post
                </div>
                <span class="checklist-desc" data-i18n="descPost"
                  >Run a Quick or Scheduled post.</span
                >
              </div>
              <div
                class="checklist-action"
                data-action="post"
                data-i18n="btnGo"
              >
                Go
              </div>
            </div>

          </div>
        </div>

        <div id="feedbackBanner" class="feedback-banner-stripe d-none">
          <div class="banner-content">
            <div class="banner-icon-wrapper">
              <i class="fa fa-pencil"></i>
            </div>
            <div class="banner-text-stripe">
              <h5 class="banner-title-stripe" data-i18n="bannerFeedbackTitle">
                Help shape the future?
              </h5>
              <p class="banner-subtitle-stripe" data-i18n="bannerFeedbackDesc">
                Share your feedback—it only takes a minute.
              </p>
            </div>
          </div>
          <div class="banner-actions-stripe">
            <a
              href="#"
              target="_blank"
              id="giveFeedbackBtn"
              class="banner-button-stripe primary"
              data-i18n="btnSure"
              >Sure</a
            >
            <button
              id="closeFeedbackBtn"
              class="banner-button-stripe secondary"
            >
              &times;
            </button>
          </div>
        </div>

        <div id="schedulerPausedBanner" class="feedback-banner-stripe d-none">
          <div class="banner-content">
            <div class="banner-icon-wrapper">
              <i class="fa fa-pause"></i>
            </div>
            <div class="banner-text-stripe">
              <h5 class="banner-title-stripe" data-i18n="bannerPaused">
                Scheduled posts are paused.
              </h5>
              <p class="banner-subtitle-stripe">
                It resumes automatically <span id="resumeTime"></span>.
              </p>
            </div>
          </div>
          <div class="banner-actions-stripe">
            <a
              href="#"
              id="resumeSchedulerNow"
              class="btn-visual-secondary"
              data-i18n="btnResume"
              >Resume</a
            >
          </div>
        </div>

        <div id="pills">
          <ul class="nav main-nav-unified">
            <li class="nav-item">
              <a
                class="nav-link"
                href="#"
                id="mainNavTemplatesBtn"
                data-i18n="navTemplates"
                >Templates</a
              >
            </li>
            <div class="nav-separator"></div>
            <li class="nav-item">
              <a
                class="nav-link active"
                href="#"
                id="mainNavPostBtn"
                data-i18n="navCompose"
                >Compose</a
              >
            </li>
            <li class="nav-item">
              <a class="nav-link" href="#" id="campaignsBTN">
                <span data-i18n="navCampaigns">Campaigns</span>
                <span class="nav-badge-dot"></span>
              </a>
            </li>
            <li class="nav-item">
              <a
                class="nav-link"
                href="#"
                id="scheduledPostsBtn"
                data-i18n="navUpcoming"
                >Upcoming</a
              >
            </li>
            <li class="nav-item">
              <a
                class="nav-link"
                href="#"
                id="historyBTN"
                data-i18n="navHistory"
                >History</a
              >
            </li>
          </ul>

          <div id="postSubNavContainer" class="switcher-container">
            <div class="sliding-switcher-track" id="postSwitcherTrack">
              <div class="switcher-highlight"></div>
              <button
                class="switcher-btn active"
                id="quickPostBTN"
                data-i18n="tabQuick"
              >
                Simple Post
              </button>
              <button class="switcher-btn" id="SchedulerBTN" data-i18n="tabAdv">
                Advanced Posting
              </button>
            </div>
          </div>

          <div id="templatesSubNavContainer" class="switcher-container d-none">
            <div class="sliding-switcher-track" id="templatesSwitcherTrack">
              <div class="switcher-highlight"></div>
              <button
                class="switcher-btn active"
                id="tagBTN"
                data-i18n="tabPostTemps"
              >
                Post Templates
              </button>
              <button
                class="switcher-btn"
                id="groupBTN"
                data-i18n="tabGroupColls"
              >
                Group Collections
              </button>
            </div>
          </div>
        </div>

        <div id="AddTagsPage" class="d-none scheduler-card">
          <div class="justify-content-between align-items-center mb-3">
            <div class="d-flex align-items-center" style="gap: 8px">
              <button
                type="button"
                name=""
                id="cancelTag"
                class="btn btn-visual-danger"
                data-i18n="btnCancel"
              >
                Cancel
              </button>
              <button
                type="button"
                id="toggleQualityScorerBtn"
                class="btn-visual-secondary"
              >
                <span data-i18n="lblPostScore">Post Score:</span>
                <span id="qualityScoreBadge" class="score-badge">--</span>
              </button>
              <button
                type="button"
                name=""
                id="saveTag"
                class="btn btn-primary"
                style="width: auto"
                data-i18n="btnSave"
              >
                Save
              </button>
            </div>
          </div>

          <div
            id="qualityScorerContainer"
            class="quality-scorer-container d-none"
          ></div>

          <div class="form-group mb-1">
            <label
              for="postTitle"
              class="d-flex justify-content-between align-items-center mb-1"
            >
              <span
                style="font-weight: 500; font-size: 14px"
                data-i18n="lblTemplateName"
                >Template Name</span
              >
              <span
                id="titleCharCounter"
                style="
                  font-size: 12px;
                  color: #6b7280;
                  background: #f3f4f6;
                  padding: 2px 6px;
                  border-radius: 4px;
                "
                >0/50</span
              >
            </label>
            <input
              type="text"
              class="form-control"
              id="postTitle"
              data-i18n="phTemplateName"
              placeholder="Enter a name for this template"
              maxlength="50"
              style="border-color: #d1d5db; border-radius: 8px"
            />
          </div>

          <div class="form-group mb-3 d-flex align-items-end" style="gap: 10px">
            <div
              class="category-combobox-wrapper"
              style="flex: 0 0 200px; max-width: 200px"
            >
              <label
                for="categoryComboboxInput"
                class="mb-1"
                style="font-weight: 500; font-size: 14px"
                data-i18n="lblCategories"
                >Categories</label
              >
              <div
                id="category-combobox-container"
                class="form-control category-combobox-container"
              >
                <div
                  id="selectedCategoriesContainer"
                  class="selected-categories-pills"
                ></div>
                <input
                  type="text"
                  id="categoryComboboxInput"
                  class="category-combobox-input"
                  data-i18n="phAssign"
                  placeholder="Assign..."
                />
              </div>
              <div
                id="selectCategoryOptions"
                class="options-container d-none"
              ></div>
            </div>

            <div class="variation-tabs-container" style="flex: 1">
              <label
                class="mb-1 d-flex justify-content-between"
                style="font-weight: 500; font-size: 14px"
              >
                <span data-i18n="lblVariations">Variations</span>
                <small
                  class="text-muted"
                  style="font-weight: 400"
                  data-i18n="hintVariations"
                  >Saves as {A|B|C...}</small
                >
              </label>

              <div class="variation-pills" id="variationPillsContainer">
                <div class="variation-pill-highlight"></div>
                <button
                  type="button"
                  class="variation-pill variation-selected"
                  data-variation="A"
                >
                  A
                </button>
                <button type="button" class="variation-pill" data-variation="B">
                  B
                </button>
                <button type="button" class="variation-pill" data-variation="C">
                  C
                </button>
                <button type="button" class="variation-pill" data-variation="D">
                  D
                </button>
              </div>
            </div>
          </div>

          <div class="form-group mb-3">
            <label
              for="editor-container"
              class="d-flex justify-content-between align-items-center mb-1"
            >
              <span
                style="font-weight: 500; font-size: 14px"
                data-i18n="lblPostContent"
                >Post Content</span
              >
              <span
                id="postContentCharCounter"
                style="
                  font-size: 12px;
                  color: #6b7280;
                  background: #f3f4f6;
                  padding: 2px 6px;
                  border-radius: 4px;
                "
                >0 characters</span
              >
            </label>
            <div
              style="
                border: 1px solid #d1d5db;
                border-radius: 10px;
                overflow: hidden;
              "
            >
              <div
                id="toolbar"
                class="py-1 px-2"
                style="
                  background-color: #fcfcff;
                  border-bottom: 1px solid #e5e7eb;
                "
              >
                <span class="ql-formats"
                  ><button class="ql-bold"></button
                  ><button class="ql-italic"></button
                ></span>
                <span class="ql-formats"
                  ><button class="ql-header" value="1"></button
                  ><button class="ql-header" value="2"></button
                ></span>
                <span class="ql-formats"
                  ><button class="ql-list" value="ordered"></button
                  ><button class="ql-list" value="bullet"></button
                ></span>
                <span class="ql-formats" style="margin-left: 0px"
                  ><button
                    class="ql-emoji"
                    type="button"
                    style="
                      padding: 0px !important;
                      margin: -1px 0px 0px 0px;
                      font-size: 14px;
                    "
                    aria-label="Insert Emoji"
                  ></button
                ></span>
                <span class="ql-formats float-right">
                  <button
                    type="button"
                    id="templateSpintaxHelperBtn"
                    class="btn-visual-secondary"
                  >
                    <i class="fa fa-random"></i>
                    <span data-i18n="btnAddSpintax">Add spintax</span>
                  </button>
                </span>
              </div>
              <div
                id="spintaxHelpPanel"
                class="p-2 d-none"
                style="
                  background-color: #eef2ff;
                  border-bottom: 1px solid #c7d2fe;
                "
              >
                <div style="font-size: 12px; color: #4338ca">
                  <strong data-i18n="panelSpintaxGuide">Spintax Guide:</strong>
                  Use <code>{option1|option2}</code>...
                </div>
              </div>
              <div class="quill-container">
                <div
                  id="editor-container"
                  style="height: 320px; border: none"
                ></div>
              </div>
            </div>
          </div>

          <div class="form-group mb-4">
            <div class="ai-compact-bar">
              <div class="ai-compact-label">
                <i class="fa fa-magic ai-compact-icon"></i>
                <span class="ai-compact-text" data-i18n="lblAIAssistant"
                  >AI Assistant</span
                >
              </div>

              <div class="ai-compact-actions">
                <button
                  type="button"
                  id="aiEnhanceButton"
                  class="btn-visual-secondary btn-sm"
                  title="Enhance text"
                  data-i18n="btnEnhance"
                >
                  Enhance text
                </button>
                <button
                  type="button"
                  id="aiGenerateButton"
                  class="btn-primary btn-sm"
                  title="Generate new"
                  data-i18n="btnGenerateAI"
                >
                  Generate new with AI
                </button>
              </div>

              <div id="aiLoadingIndicator" class="ai-compact-status d-none">
                <div class="ai-compact-spinner"></div>
                Processing...
              </div>
              <div id="aiErrorIndicator" class="ai-compact-error d-none">
                <i class="fa fa-exclamation-circle"></i>
                <span id="quickAiErrorText">Error</span>
              </div>
            </div>
          </div>

          <div class="form-group mb-3">
            <label
              for="imageInput"
              class="d-flex justify-content-between align-items-center mb-1"
            >
              <span
                style="font-weight: 500; font-size: 14px"
                data-i18n="lblMedia"
                >Media (Images & Videos)</span
              >
              <span
                id="mediaCounter"
                style="
                  font-size: 12px;
                  color: #6b7280;
                  background: #f3f4f6;
                  padding: 2px 6px;
                  border-radius: 4px;
                "
                >0 items</span
              >
            </label>

            <div
              id="mediaDropzone"
              style="
                border: 1px dashed #d1d5db;
                border-radius: 8px;
                padding: 16px;
                background-color: #f7fafc;
                text-align: center;
                margin-bottom: 10px;
                transition: all 0.2s ease;
              "
            >
              <div style="display: flex; align-items: center">
                <button
                  style="
                    height: 60px;
                    width: 60px;
                    font-size: 24px;
                    border-radius: 8px;
                    min-width: 60px;
                    background: white;
                    border: 1px solid #d1d5db;
                    color: #6b7280;
                    display: flex;
                    align-items: center;
                    justify-content: center;
                    cursor: pointer;
                    transition: all 0.2s ease;
                    margin-right: 12px;
                  "
                  type="button"
                  id="insertImageButton"
                >
                  <i class="fa fa-plus"></i>
                </button>
                <div style="text-align: left">
                  <div
                    style="font-size: 13px; font-weight: 500; color: #374151"
                    data-i18n="lblAddMedia"
                  >
                    Add images or videos
                  </div>
                  <div
                    style="font-size: 12px; color: #6b7280"
                    data-i18n="descDragDrop"
                  >
                    Drag & drop files here or click the plus button
                  </div>
                  <div
                    style="font-size: 9px; color: #6b7280"
                    data-i18n="descFormats"
                  >
                    Supported formats: Images, MP4, WebM videos
                  </div>
                </div>
              </div>
            </div>

            <div style="overflow-x: auto; scrollbar-width: thin">
              <div
                id="selectedImages"
                class="d-flex gap-2"
                style="flex-wrap: nowrap"
              ></div>
            </div>

            <input
              type="file"
              class="form-control-file d-none"
              id="imageInput"
              accept="image/jpeg, image/png, image/gif, image/tiff, image/heif, image/webp, video/mp4, video/mp3, video/webm"
              multiple
            />
          </div>

          <div id="colorSelector" class="form-group mb-3">
            <label
              class="d-flex justify-content-between align-items-center mb-2"
            >
              <span
                style="font-weight: 500; font-size: 14px"
                data-i18n="lblBgColor"
                >Background Color</span
              >
              <small
                style="color: #6b7280; font-style: italic"
                data-i18n="hintBgColor"
                >For posts with max 130 characters</small
              >
            </label>

            <div class="d-flex flex-wrap" style="gap: 10px">
              <button
                class="btn color-button color-preview"
                data-color="#18191a"
                style="
                  background-color: #f9fafb;
                  width: 45px;
                  height: 45px;
                  border-radius: 8px;
                  border: 2px solid #000;
                  transition: transform 0.2s ease;
                "
                title="Default (Black)"
              >
                x
              </button>
              <button
                class="btn color-button color-preview"
                data-color="#e2013b"
                style="
                  background-color: #e2013b;
                  width: 45px;
                  height: 45px;
                  border-radius: 8px;
                  border: none;
                  transition: transform 0.2s ease;
                "
                title="Red"
              ></button>
              <button
                class="btn color-button color-preview"
                data-color="#ff6323"
                style="
                  background-color: #ff6323;
                  width: 45px;
                  height: 45px;
                  border-radius: 8px;
                  border: none;
                  transition: transform 0.2s ease;
                "
                title="Orange"
              ></button>
              <button
                class="btn color-button color-preview"
                data-color="#c600ff"
                style="
                  background-color: #c600ff;
                  width: 45px;
                  height: 45px;
                  border-radius: 8px;
                  border: none;
                  transition: transform 0.2s ease;
                "
                title="Purple"
              ></button>
              <button
                class="btn color-button color-preview"
                data-color="#26927f"
                style="
                  background-color: #26927f;
                  width: 45px;
                  height: 45px;
                  border-radius: 8px;
                  border: none;
                  transition: transform 0.2s ease;
                "
                title="Teal"
              ></button>
              <button
                class="btn color-button color-preview"
                data-color="#f6c7c6"
                style="
                  background-color: #f6c7c6;
                  width: 45px;
                  height: 45px;
                  border-radius: 8px;
                  border: none;
                  transition: transform 0.2s ease;
                "
                title="Pink"
              ></button>
              <button
                class="btn color-button color-preview"
                data-color="#2088af"
                style="
                  background-color: #2088af;
                  width: 45px;
                  height: 45px;
                  border-radius: 8px;
                  border: none;
                  transition: transform 0.2s ease;
                "
                title="Blue"
              ></button>
            </div>
          </div>
        </div>
        <style>
          .color-preview:hover {
            transform: scale(1.1);
            cursor: pointer;
            z-index: 1;
          }
        </style>

        <div id="addProductPage" class="d-none scheduler-card">
          <div class="d-flex mt-2 justify-content-end">
            <button
              type="button"
              class="btn btn-visual-danger mr-2"
              id="cancelProduct"
              data-i18n="btnCancel"
            >
              Cancel
            </button>
            <button
              type="button"
              class="btn btn-dark"
              style="width: -webkit-fill-available"
              id="saveProduct"
              data-i18n="btnSave"
            >
              Save
            </button>
          </div>
          <label for="productTitle" class="mt-4" data-i18n="lblProdName"
            >Product Title</label
          >
          <input
            type="text"
            class="form-control mb-3"
            id="productTitle"
            placeholder="Product Title"
          />
          <label for="productPrice" data-i18n="lblPrice">Price</label>
          <input
            type="number"
            class="form-control mb-3"
            id="productPrice"
            placeholder="Price"
          />
          <label for="productCondition" data-i18n="lblCondition"
            >Condition</label
          >
          <select class="form-control mb-3" id="productCondition">
            <option>New</option>
            <option>Used - Like New</option>
            <option>Used - Good</option>
            <option>Used - Fair</option>
          </select>
          <label for="productDescription" data-i18n="lblDesc"
            >Description</label
          >
          <textarea
            class="form-control mb-3"
            id="productDescription"
            rows="6"
            placeholder="Product Description"
          ></textarea>

          <div class="form-group mt-3">
            <p data-i18n="lblPickupOpts">Pickup Options</p>
            <div class="form-check">
              <input
                class="form-check-input"
                type="checkbox"
                value="publicMeetup"
                id="publicMeetup"
              />
              <label
                class="form-check-label"
                for="publicMeetup"
                data-i18n="lblPublicMeet"
                >Public Meetup</label
              >
            </div>
            <div class="form-check">
              <input
                class="form-check-input"
                type="checkbox"
                value="doorPickup"
                id="doorPickup"
              />
              <label
                class="form-check-label"
                for="doorPickup"
                data-i18n="lblDoorPickup"
                >Door Pickup</label
              >
            </div>
            <div class="form-check">
              <input
                class="form-check-input"
                type="checkbox"
                value="doorDropoff"
                id="doorDropoff"
              />
              <label
                class="form-check-label"
                for="doorDropoff"
                data-i18n="lblDoorDrop"
                >Door Dropoff</label
              >
            </div>
          </div>

          <div class="form-group" style="overflow-x: scroll">
            <p class="mb-2" data-i18n="lblAddMedia">
              Add media (video - image)
            </p>
            <div class="d-flex" style="margin-bottom: 5px">
              <button
                style="
                  height: 70px;
                  width: 70px;
                  font-size: 13px;
                  margin-right: 4px;
                  border-radius: 10px;
                  min-width: 70px;
                "
                type="button"
                class="btn btn-outline-dark"
                id="insertProductImageButton"
              >
                +
              </button>
              <div id="selectedProductImages" class="d-flex gap-2"></div>
            </div>
          </div>
        </div>

        <div id="addGroupsPage" class="d-none scheduler-card">
          <div class="d-flex mt-2 justify-content-end">
            <button
              type="button"
              name=""
              id="cancelGroups"
              class="btn btn-visual-danger mr-2"
              data-i18n="btnCancel"
            >
              Cancel
            </button>
            <button
              type="button"
              name=""
              id="saveGroups"
              class="btn btn-primary"
              style="width: -webkit-fill-available"
              data-i18n="saveCollection"
            >
              Save Group Collection
            </button>
          </div>

          <label for="addGroupInput" class="mt-4" data-i18n="lblAddGroupColl"
            >Add a new group collection</label
          >
          <input
            type="text"
            class="form-control mb-3"
            id="groupTitle"
            data-i18n="phCollName"
            placeholder="Name of the group collection"
          />
          <input
            type="text"
            class="form-control mb-3"
            id="searchGroupInput"
            data-i18n="phSearchGroups"
            placeholder="Search Groups"
          />
          <button
            type="button"
            class="btn-visual-secondary"
            id="addGroupButton"
            data-i18n="btnAddLink"
          >
            Add a new link
          </button>
          <button
            type="button"
            id="cutUpGroupsBtn"
            class="btn-visual-secondary mr-2 d-none"
            data-i18n="btnSplit"
            title="Split this collection into smaller parts"
          >
            Split
          </button>

          <div class="form-group mt-4">
            <div id="groupInputsContainer"></div>
          </div>
          <div id="root"></div>
        </div>

        <div id="autoJoinGroupsPage" class="d-none scheduler-card">
          <div class="d-flex mt-2 justify-content-end">
            <button
              type="button"
              name=""
              id="cancelAutoJoinGroupsBTN"
              class="btn-visual-danger mr-2"
              data-i18n="btnCancel"
            >
              Cancel
            </button>
            <button
              type="button"
              name=""
              id="startAutoJoinBTN"
              class="btn btn-primary"
              style="width: -webkit-fill-available"
              data-i18n="btnAutoJoin"
            >
              Auto join groups
            </button>
          </div>

          <label for="searchParameter" class="mt-4" data-i18n="lblSearchParam"
            >Search Parameter</label
          >
          <input
            type="text"
            class="form-control mb-3"
            id="searchParameter"
            data-i18n="phSearchParam"
            placeholder="Enter search keyword"
          />
          <label for="joinCounter" data-i18n="lblJoinCount"
            >How many groups should be joined?</label
          >
          <input
            type="number"
            class="form-control mb-3"
            id="joinCounter"
            placeholder="10"
          />
          <label for="groupSizeFilter" data-i18n="lblMinMembers"
            >Only join groups with at least this many members:</label
          >
          <input
            type="number"
            class="form-control mb-3"
            id="groupSizeFilter"
            placeholder="5000"
          />

          <div class="mb-3 card p-3">
            <div>
              <input type="checkbox" id="saveGroupsAfterJoining" class="mr-2" />
              <label for="saveGroupsAfterJoining" data-i18n="lblSaveJoined"
                >Save newly joined groups</label
              >
            </div>
            <input
              type="text"
              class="form-control mr-2"
              id="saveGroupName"
              data-i18n="phSaveGroupAs"
              data-i18n-target="placeholder"
              placeholder="Enter group name to save as"
            />
          </div>

          <div class="info-banner">
            <i class="info-banner-icon fa fa-info-circle"></i>
            <div class="info-banner-text" data-i18n="warnFbLimit">
              Facebook limits how many groups you can join...
            </div>
          </div>
        </div>

        <div id="CampaignsPage" class="d-none">
          <div id="campaignListView">
            <div class="d-flex justify-content-between align-items-center mb-3">
              <h5
                class="mb-0 font-weight-bold"
                style="color: #1f2937"
                data-i18n="lblCampaigns"
              >
                Campaigns (beta)
              </h5>
              <div class="d-flex gap-2">
                <button
                  id="openAiWizardBtn"
                  class="btn btn-primary btn-sm mr-2"
                >
                  <i class="fa fa-magic"></i>
                  <span data-i18n="btnAiWizard">AI Wizard</span>
                </button>
                <button
                  id="createNewCampaignBtn"
                  class="btn-visual-secondary btn-sm"
                  data-i18n="btnCreateNew"
                >
                  Create New
                </button>
              </div>
            </div>
            <div class="card card-body">
              <div id="campaignsListContainer">
                <div class="text-center py-5">
                  <div
                    style="font-size: 2rem; color: #e5e7eb; margin-bottom: 10px"
                  >
                    <i class="fa fa-cubes"></i>
                  </div>
                  <h6 style="color: #374151" data-i18n="emptyCampaigns">
                    No campaigns yet
                  </h6>
                  <p class="text-muted small" data-i18n="descEmptyCamp">
                    Create your first automated strategy to get started.
                  </p>
                </div>
              </div>
            </div>

            <div class="feature-spotlight-card">
              <div class="spotlight-header">
                <span class="spotlight-badge">NEW</span>
                <span class="spotlight-title" data-i18n="spotCampTitle"
                  >Campaign Automation</span
                >
              </div>

              <div class="spotlight-body">
                <p class="spotlight-intro" data-i18n="spotCampDesc">
                  Automate your entire workflow. Chain multiple posts, set smart
                  delays, and loop indefinitely.
                </p>

                <div class="spotlight-steps">
                  <div class="step-mini">
                    <span class="step-num">1</span>
                    <span data-i18n="spotStepPost"
                      >Add <strong>Post</strong> block</span
                    >
                  </div>
                  <div class="step-divider"></div>
                  <div class="step-mini">
                    <span class="step-num">2</span>
                    <span data-i18n="spotStepWait"
                      >Add <strong>Wait</strong> block</span
                    >
                  </div>
                  <div class="step-divider"></div>
                  <div class="step-mini">
                    <span class="step-num">3</span>
                    <span data-i18n="spotStepLoop"
                      >Set <strong>Loop</strong></span
                    >
                  </div>
                </div>
              </div>
            </div>
          </div>

          <div id="campaignBuilderView" class="d-none">
            <div class="card">
              <div class="card-body">
                <div class="campaign-header mb-3">
                  <button
                    id="backToCampaignListBtn"
                    class="btn-visual-secondary mr-2"
                    title="Back to List"
                  >
                    <i class="fa fa-arrow-left"></i>
                  </button>
                  <div class="form-group mb-0 flex-grow-1 mr-2">
                    <input
                      type="text"
                      class="form-control font-weight-bold"
                      id="campaignTitle"
                      placeholder="Campaign Name"
                    />
                  </div>
                  <button
                    class="btn btn-primary"
                    id="saveCampaignBtn"
                    style="min-width: 120px"
                    data-i18n="btnLaunch"
                  >
                    Launch
                  </button>
                </div>

                <div class="campaign-toolbox-container mb-3">
                  <h6 class="toolbox-header">
                    <i class="fa fa-cubes"></i>
                    <span data-i18n="headerDragBlocks"
                      >DRAG THE BUILDING BLOCKS</span
                    >
                  </h6>
                  <div id="campaignToolbar" class="campaign-toolbar">
                    <div
                      class="toolbar-item"
                      draggable="true"
                      data-type="trigger"
                    >
                      <div class="toolbar-icon bg-slate">
                        <i class="fa fa-clock-o"></i>
                      </div>
                      <span data-i18n="blockTrigger">Trigger</span>
                    </div>
                    <div class="toolbar-item" draggable="true" data-type="post">
                      <div class="toolbar-icon bg-indigo">
                        <i class="fa fa-paper-plane"></i>
                      </div>
                      <span data-i18n="blockPost">Post</span>
                    </div>
                    <div class="toolbar-item" draggable="true" data-type="wait">
                      <div class="toolbar-icon bg-amber">
                        <i class="fa fa-hourglass-half"></i>
                      </div>
                      <span data-i18n="blockWait">Wait</span>
                    </div>
                    <div class="toolbar-item" draggable="true" data-type="loop">
                      <div class="toolbar-icon bg-purple">
                        <i class="fa fa-refresh"></i>
                      </div>
                      <span data-i18n="blockLoop">Loop</span>
                    </div>
                    <div class="toolbar-item" draggable="true" data-type="stop">
                      <div class="toolbar-icon bg-rose">
                        <i class="fa fa-stop-circle"></i>
                      </div>
                      <span data-i18n="blockStop">Stop</span>
                    </div>
                  </div>
                </div>

                <div class="campaign-canvas-wrapper">
                  <div id="campaignCanvas" class="campaign-canvas">
                    <div class="canvas-empty-state">
                      <i
                        class="fa fa-arrow-up text-muted mb-2"
                        style="font-size: 24px"
                      ></i>
                      <p>
                        Drag the <strong>Trigger</strong> block here to start
                      </p>
                    </div>
                  </div>
                </div>
              </div>
            </div>
          </div>
        </div>

        <div id="TagsPage" class="d-none mt-3">
          <div class="justify-content-between align-items-center mb-2">
            <div class="d-flex align-items-center" style="gap: 8px">
              <button
                type="button"
                class="btn-visual-secondary"
                id="AddTagBTN"
                data-i18n="btnCreateTemplate"
              >
                Create new post template
              </button>
              <div id="sort-filter-popover-container" class="popover-container">
                <button
                  type="button"
                  class="btn-visual-secondary"
                  id="sortFilterBtn"
                >
                  <i class="fa fa-sort"></i>
                  <span data-i18n="btnSortFilter">Sort & Filter</span>
                </button>
                <div id="sort-filter-popover" class="popover-content d-none">
                  <div class="popover-section">
                    <h6 class="popover-header" data-i18n="lblSortBy">
                      Sort by
                    </h6>
                    <div class="sort-options">
                      <button
                        class="sort-option"
                        data-sort-by="default"
                        data-sort-dir="asc"
                      >
                        <i class="fa fa-bars"></i>
                        <span data-i18n="btnDefault">Default</span>
                      </button>
                      <button
                        class="sort-option"
                        data-sort-by="name"
                        data-sort-dir="asc"
                      >
                        <i class="fa fa-sort-alpha-asc"></i>
                        <span data-i18n="btnNameAZ">Name (A-Z)</span>
                      </button>
                      <button
                        class="sort-option"
                        data-sort-by="name"
                        data-sort-dir="desc"
                      >
                        <i class="fa fa-sort-alpha-desc"></i>
                        <span data-i18n="btnNameZA">Name (Z-A)</span>
                      </button>
                    </div>
                  </div>

                  <div class="popover-section">
                    <h6 class="popover-header" data-i18n="lblFilterCat">
                      Filter by Category
                    </h6>
                    <div
                      id="popover-category-list"
                      class="category-filter-list"
                    ></div>
                  </div>
                </div>
              </div>

              <button
                type="button"
                class="btn-visual-secondary"
                id="manageCategoriesBtn"
                data-i18n="btnManageCat"
              >
                Manage Categories
              </button>
            </div>
          </div>

          <div id="savetagsloop"></div>

          <div id="templatesSpotlight" class="feature-spotlight-card mt-4">
            <div class="spotlight-header">
              <span class="spotlight-badge">TIP</span>
              <span class="spotlight-title" data-i18n="tipTemplates"
                >Power Up Your Templates</span
              >
            </div>

            <div class="spotlight-body">
              <p class="spotlight-intro" data-i18n="tipTemplatesDesc">
                Templates save time and keep your messaging consistent.
              </p>
              <div class="spotlight-steps">
                <div class="step-mini">
                  <span class="step-num"><i class="fa fa-random"></i></span
                  ><span data-i18n="tipStepSpin"
                    >Use <strong>Spintax</strong></span
                  >
                </div>
                <div class="step-divider"></div>
                <div class="step-mini">
                  <span class="step-num"><i class="fa fa-columns"></i></span
                  ><span data-i18n="tipStepVar"
                    >Create <strong>Variations</strong></span
                  >
                </div>
                <div class="step-divider"></div>
                <div class="step-mini">
                  <span class="step-num"><i class="fa fa-magic"></i></span
                  ><span data-i18n="tipStepAI"
                    ><strong>AI</strong> Rewrite</span
                  >
                </div>
              </div>
            </div>
          </div>
        </div>

        <div id="productPage" class="mt-3 d-none">
          <div class="d-flex justify-content-between align-items-center mb-2">
            <p style="margin: 0px" data-i18n="lblSavedProds">Saved Products</p>
            <button
              type="button"
              class="btn-visual-secondary"
              id="addProductBTN"
              data-i18n="btnAddProd"
            >
              Add new product template
            </button>
          </div>
          <div id="saveproductsloop"></div>
        </div>

        <div id="groupsPage" class="mt-3 d-none">
          <div class="d-flex justify-content-between align-items-center mb-2">
            <div>
              <button
                type="button"
                class="btn-visual-secondary"
                id="addGroupsBTN"
                data-i18n="btnCreateColl"
              >
                Create new collection
              </button>
              <button
                type="button"
                class="btn-visual-secondary"
                id="getProfileGroups"
                data-i18n="btnExtract"
              >
                Extract from FB
              </button>
              <button
                type="button"
                class="btn-visual-secondary"
                id="exportGroupsButton"
                title="Export All Group Collections to JSON file"
              >
                <i class="fa fa-upload"></i>
              </button>
              <button
                type="button"
                class="btn-visual-secondary"
                id="importGroupsButton"
                title="Import Group Collections from JSON file"
              >
                <i class="fa fa-download"></i>
              </button>
              <button
                type="button"
                class="btn-visual-secondary"
                id="autoJoinGroupsBTN"
                data-i18n="btnAutoJoin"
              >
                Auto join groups
              </button>
            </div>
          </div>

          <div id="savegroupsloop"></div>

          <div id="groupsSpotlight" class="feature-spotlight-card mt-4">
            <div class="spotlight-header">
              <span class="spotlight-badge">TIP</span>
              <span class="spotlight-title" data-i18n="cardGroupsTip"
                >Smart Group Management</span
              >
            </div>
            <div class="spotlight-body">
              <p class="spotlight-intro" data-i18n="tipGroupsDesc">
                Organize groups by niche to target the right audience every
                time.
              </p>
              <div class="spotlight-steps">
                <div class="step-mini">
                  <span class="step-num"
                    ><i class="fa fa-cloud-download"></i></span
                  ><span data-i18n="spotStepExtract"
                    ><strong>Extract</strong></span
                  >
                </div>
                <div class="step-divider"></div>
                <div class="step-mini">
                  <span class="step-num"><i class="fa fa-filter"></i></span
                  ><span data-i18n="spotStepSplit"
                    ><strong>Split</strong> Lists</span
                  >
                </div>
                <div class="step-divider"></div>
                <div class="step-mini">
                  <span class="step-num"><i class="fa fa-folder-open"></i></span
                  ><span data-i18n="tipSegment"
                    ><strong>Segment</strong> by Niche</span
                  >
                </div>
              </div>
            </div>
          </div>
          <input
            type="file"
            id="importGroupsInput"
            accept=".json"
            style="display: none"
          />
        </div>

        <div id="SchedulerPage" class="scheduler-container mt-3 d-none">
          <div class="card card-body">
            <div class="form-section">
              <div class="section-header mb-2">
                <h3
                  class="section-subtitle st"
                  style="font-weight: 500; font-size: 14px"
                  data-i18n="headerSelectTemplates"
                >
                  Select post templates to publish
                </h3>
              </div>
              <div class="form-group">
                <div id="selectPostWrapper" class="custom-multiselect">
                  <input
                    type="text"
                    id="selectPostInput"
                    class="form-control"
                    data-i18n="phSelectTemplates"
                    placeholder="Select one or more post templates..."
                    readonly
                  />
                  <div
                    id="selectPostOptions"
                    class="options-container d-none"
                  ></div>
                </div>
                <div
                  id="selectedPostsContainer"
                  class="selected-tags-container"
                ></div>
              </div>
            </div>

            <div class="form-section">
              <div class="section-header mb-2">
                <h3
                  class="section-subtitle"
                  style="font-weight: 500; font-size: 14px"
                  data-i18n="headerSelectGroups"
                >
                  Select target group collections
                </h3>
              </div>
              <div class="form-group">
                <div class="d-flex" style="gap: 8px">
                  <div
                    id="selectGroupWrapper"
                    class="custom-multiselect"
                    style="flex-grow: 1"
                  >
                    <input
                      type="text"
                      id="selectGroupInput"
                      class="form-control"
                      data-i18n="phSelectGroups"
                      placeholder="Select one or more group collections..."
                      readonly
                    />
                    <div
                      id="selectGroupOptions"
                      class="options-container d-none"
                    ></div>
                  </div>
                  <button
                    type="button"
                    id="advancedGroupSelectionBtn"
                    class="btn-visual-secondary"
                    data-i18n="btnAdvSelector"
                  >
                    Advanced selector
                  </button>
                </div>
                <div
                  id="selectedGroupsContainer"
                  class="selected-tags-container"
                ></div>
              </div>
            </div>

            <div class="form-section d-none" id="postOrderSection">
              <div class="section-header mb-2">
                <h3 class="section-subtitle" data-i18n="headerOrder">
                  Posting Order
                </h3>
              </div>
              <div style="display: none">
                <input
                  type="radio"
                  id="orderSequential"
                  name="postOrder"
                  value="sequential"
                  checked
                />
                <input
                  type="radio"
                  id="orderAlternate"
                  name="postOrder"
                  value="alternate"
                />
              </div>
              <div id="postingOrderPills" class="history-stats-pills">
                <div class="stat-pill-highlight"></div>
                <button
                  type="button"
                  class="stat-pill"
                  data-value="sequential"
                  data-i18n="lblSequential"
                >
                  Sequential
                </button>
                <button
                  type="button"
                  class="stat-pill"
                  data-value="alternate"
                  data-i18n="lblAlternate"
                >
                  Alternate
                </button>
              </div>
              <div class="form-hint mt-2" data-i18n="hintOrder">
                Sequential: Posts A, A... then B, B... | Alternate: A, B... then
                A, B...
              </div>
            </div>

            <div id="aiVariationSection" class="form-section d-none">
              <div class="section-header mb-2">
                <h3 class="section-subtitle" data-i18n="headerAiVar">
                  AI Post Variations
                </h3>
              </div>
              <div class="settings-panel">
                <div class="settings-option">
                  <div class="toggle-switch">
                    <input
                      type="checkbox"
                      id="generateAiVariations"
                      name="generateAiVariations"
                      class="toggle-input"
                    />
                    <label
                      for="generateAiVariations"
                      class="toggle-label"
                    ></label>
                  </div>
                  <div class="option-details">
                    <span class="option-name" data-i18n="lblGenAiVar"
                      >Generate AI Variations</span
                    >
                    <span class="option-description" data-i18n="descGenAiVar"
                      >Create variations with different tones
                      automatically.</span
                    >
                  </div>
                </div>
                <div id="aiVariationOptions" class="d-none mt-3">
                  <div class="settings-option">
                    <label
                      for="aiVariationCount"
                      class="form-label mr-2"
                      data-i18n="lblNumVar"
                      >Number of Variations:</label
                    >
                    <input
                      type="number"
                      id="aiVariationCount"
                      class="form-control"
                      value="2"
                      min="1"
                      max="8"
                      style="max-width: 100px"
                    />
                  </div>
                </div>
              </div>
            </div>

            <div class="">
              <div class="section-header mb-2">
                <h3 class="section-subtitle" data-i18n="headerPause">
                  Pause & Protection
                </h3>
              </div>
              <div class="d-flex" style="gap: 15px">
                <div class="form-group" style="flex: 1">
                  <label
                    for="linkCount"
                    class="form-label"
                    style="font-weight: 500; font-size: 14px"
                    data-i18n="lblInterval"
                    >Interval</label
                  >
                  <div class="input-with-hint">
                    <div class="input-group">
                      <input
                        type="number"
                        id="linkCount"
                        class="form-control"
                        value="1"
                        min="1"
                      />
                      <div class="input-group-append">
                        <span
                          class="input-group-text"
                          style="
                            font-size: 12px;
                            background: #f8fafc;
                            color: #64748b;
                            border-radius: 0px 10px 10px 0px;
                          "
                          data-i18n="unitPosts"
                          >posts</span
                        >
                      </div>
                    </div>
                    <div class="form-hint" data-i18n="hintInterval">
                      Between pauses
                    </div>
                  </div>
                </div>

                <div class="form-group" style="flex: 1">
                  <label
                    for="enterTime"
                    class="form-label"
                    style="font-weight: 500; font-size: 14px"
                    data-i18n="lblWaitTime"
                    >Wait Time</label
                  >
                  <div class="input-with-hint">
                    <div class="input-group">
                      <input
                        type="number"
                        id="enterTime"
                        class="form-control"
                        value="2"
                        min="0"
                        step="0.1"
                      />
                      <div class="input-group-append">
                        <span
                          class="input-group-text"
                          style="
                            font-size: 12px;
                            background: #f8fafc;
                            color: #64748b;
                            border-radius: 0px 10px 10px 0px;
                          "
                          data-i18n="unitMin"
                          >min</span
                        >
                      </div>
                    </div>
                    <div class="form-hint" data-i18n="hintWait">
                      Randomized duration
                    </div>
                  </div>
                </div>
              </div>

              <div class="form-group mt-3">
                <div class="settings-panel">
                  <!-- NEW: Scheduler Post Anonymously -->
                  <div class="settings-option">
                    <div class="toggle-switch">
                      <input
                        type="checkbox"
                        id="schedPostAnonymously"
                        name="postAnonymously"
                        class="toggle-input"
                      />
                      <label
                        for="schedPostAnonymously"
                        class="toggle-label"
                      ></label>
                    </div>
                    <div class="option-details">
                      <span
                        class="option-name"
                        style="font-weight: 500; font-size: 14px"
                        data-i18n="lblAnonPost"
                        >Post Anonymously</span
                      >
                      <span class="option-description" data-i18n="descAnonPost"
                        >Fails if group doesn't support it</span
                      >
                    </div>
                  </div>
                  <div class="settings-option">
                    <div class="toggle-switch">
                      <input
                        type="checkbox"
                        id="delayAfterFailure"
                        name="delayAfterFailure"
                        class="toggle-input"
                      />
                      <label
                        for="delayAfterFailure"
                        class="toggle-label"
                      ></label>
                    </div>
                    <div class="option-details">
                      <span
                        class="option-name"
                        style="font-weight: 500; font-size: 14px"
                        data-i18n="lblSafeDelay"
                        >Safety delay on fail</span
                      >
                      <span class="option-description" data-i18n="descSafeDelay"
                        >Wait full time even if post fails.</span
                      >
                    </div>
                  </div>
                  <div class="settings-option">
                    <div class="toggle-switch">
                      <input
                        type="checkbox"
                        id="nightPost"
                        name="nightPost"
                        class="toggle-input"
                      />
                      <label for="nightPost" class="toggle-label"></label>
                    </div>
                    <div class="option-details">
                      <span
                        class="option-name"
                        style="font-weight: 500; font-size: 14px"
                        data-i18n="lblNightMode"
                        >Avoid night posting</span
                      >
                      <span class="option-description" data-i18n="descNightMode"
                        >Don't post 10PM - 7AM</span
                      >
                    </div>
                  </div>
                  <div class="settings-option">
                    <div class="toggle-switch">
                      <input
                        type="checkbox"
                        id="compressImage"
                        name="compressImage"
                        class="toggle-input"
                        checked
                      />
                      <label for="compressImage" class="toggle-label"></label>
                    </div>
                    <div class="option-details">
                      <span
                        class="option-name"
                        style="font-weight: 500; font-size: 14px"
                        data-i18n="lblCompress"
                        >Compress images</span
                      >
                      <span class="option-description" data-i18n="descCompress"
                        >Optimize size (recommended)</span
                      >
                    </div>
                  </div>
                </div>
              </div>
            </div>

            <div class="form-section mt-3">
              <label
                class="form-label"
                style="font-weight: 500; font-size: 14px"
                data-i18n="lblSecLevel"
                >Posting Security Level</label
              >
              <div class="security-slider-v2">
                <input
                  type="range"
                  id="securityLevelSlider"
                  min="1"
                  max="3"
                  value="2"
                  step="1"
                />
                <div class="slider-track-v2">
                  <div class="slider-thumb-v2"></div>
                </div>
                <div class="slider-labels-v2">
                  <div class="slider-label-v2" data-value="1">
                    <i class="fa fa-rocket"></i>
                    <span data-i18n="lblFast">Fast</span>
                  </div>
                  <div class="slider-label-v2" data-value="2">
                    <i class="fa fa-balance-scale"></i>
                    <span data-i18n="lblBalanced">Balanced</span>
                  </div>
                  <div class="slider-label-v2" data-value="3">
                    <i class="fa fa-shield"></i>
                    <span data-i18n="lblSafe">Safe</span>
                  </div>
                </div>
              </div>
              <p
                id="securityLevelDescription"
                class="form-hint mt-2"
                data-i18n="descSecLevel"
              >
                Balances posting speed with account safety measures.
              </p>
            </div>

            <div class="form-section">
              <div class="section-header mb-2">
                <h3 class="section-subtitle" data-i18n="headerStrategy">
                  Posting Strategy
                </h3>
              </div>
              <div class="posting-methods">
                <div class="method-card">
                  <input
                    type="radio"
                    id="directApiMethod"
                    name="postingMethod"
                    value="directApi"
                    class="method-radio"
                  />
                  <label for="directApiMethod" class="method-card-label">
                    <div class="method-card-content">
                      <div class="method-card-header">
                        <span
                          class="method-name"
                          style="font-weight: 500; font-size: 14px"
                          data-i18n="modeSpeed"
                          >Speed Mode</span
                        >
                        <span class="method-tag new-tag" data-i18n="tagRec"
                          >Recommended</span
                        >
                      </div>
                      <span class="method-description" data-i18n="descSpeed"
                        >Turbocharge posting with Facebook API. Fast &
                        Reliable.</span
                      >
                    </div>
                  </label>
                </div>
                <div class="method-card">
                  <input
                    type="radio"
                    id="popupMethod"
                    name="postingMethod"
                    value="popup"
                    class="method-radio"
                    checked
                  />
                  <label for="popupMethod" class="method-card-label">
                    <div class="method-card-content">
                      <div class="method-card-header">
                        <span
                          class="method-name"
                          style="font-weight: 500; font-size: 14px"
                          data-i18n="modeClassic"
                          >Classic Mode</span
                        >
                        <span class="method-tag old-tag" data-i18n="tagCompat"
                          >Max Compatibility</span
                        >
                      </div>
                      <span class="method-description" data-i18n="descClassic"
                        >Visual automation. Good for video.</span
                      >
                    </div>
                  </label>
                </div>
              </div>
            </div>

            <div class="form-section comment-settings-section">
              <div class="section-header mb-2">
                <h3 class="section-subtitle" data-i18n="headerComments">
                  Comment Settings
                </h3>
              </div>
              <div class="comment-options">
                <div class="option-card">
                  <input
                    type="radio"
                    id="enableComments"
                    name="commentOption"
                    value="enable"
                    class="option-radio"
                    checked
                  />
                  <label for="enableComments" class="option-card-label">
                    <div class="option-card-content">
                      <span
                        class="option-card-title"
                        style="font-weight: 500; font-size: 14px"
                        data-i18n="lblEnableComm"
                        >Enable Comments</span
                      >
                    </div>
                  </label>
                </div>
                <div class="option-card">
                  <input
                    type="radio"
                    id="disableComments"
                    name="commentOption"
                    value="disable"
                    class="option-radio"
                  />
                  <label for="disableComments" class="option-card-label">
                    <div class="option-card-content">
                      <span
                        class="option-card-title"
                        style="font-weight: 500; font-size: 14px"
                        data-i18n="lblDisableComm"
                        >Disable Comments</span
                      >
                    </div>
                  </label>
                </div>
                <div class="option-card">
                  <input
                    type="radio"
                    id="firstComment"
                    name="commentOption"
                    value="comment"
                    class="option-radio"
                  />
                  <label for="firstComment" class="option-card-label">
                    <div class="option-card-content">
                      <span
                        class="option-card-title"
                        style="font-weight: 500; font-size: 14px"
                        data-i18n="lblFirstComm"
                        >Add First Comment</span
                      >
                    </div>
                  </label>
                </div>
              </div>
              <div id="firstCommentTextContainer" class="d-none mt-3">
                <textarea
                  class="form-control"
                  id="firstCommentText"
                  rows="3"
                  data-i18n="phFirstComm"
                  placeholder="Enter your comment text here..."
                ></textarea>
              </div>
            </div>

            <div
              class="action-buttons"
              style="display: flex; flex-direction: column; gap: 10px"
            >
              <button
                id="cancelEditScheduleBtn"
                class="btn-secondary d-none"
                style="width: 100%"
                data-i18n="btnCancelEdit"
              >
                Cancel Edit
              </button>
              <div class="d-flex" style="gap: 12px; width: 100%">
                <div
                  id="startPostingWrapper"
                  style="flex: 1; display: flex; gap: 15px"
                >
                  <button
                    id="schedulePostButton"
                    class="btn-secondary"
                    style="flex: 1"
                    disabled
                    data-i18n="btnSchedule"
                  >
                    Schedule
                  </button>
                  <button
                    id="startPosting"
                    class="btn btn-primary"
                    style="width: 100%"
                    disabled
                    data-i18n="btnPostNow"
                  >
                    Post Now
                  </button>
                </div>
              </div>
            </div>
          </div>
        </div>

        <div id="quickPostPage" class="mt-3">
          <div class="card">
            <div class="card-body">
              <div class="form-group mb-1">
                <label
                  for="quickSelectGroupInput"
                  class="d-flex justify-content-between align-items-center mb-1"
                >
                  <span
                    style="font-weight: 500; font-size: 14px"
                    data-i18n="lblQuickGroups"
                    >Select target group collections</span
                  >
                  <span
                    id="quickGroupCount"
                    data-i18n="countSelected"
                    data-i18n-args='["0"]'
                    style="
                      font-size: 12px;
                      color: #6b7280;
                      background: #f3f4f6;
                      padding: 2px 6px;
                      border-radius: 4px;
                    "
                    >0 selected</span
                  >
                </label>
                <div class="d-flex" style="gap: 8px">
                  <div
                    id="quickSelectGroupWrapper"
                    class="custom-multiselect"
                    style="flex-grow: 1"
                  >
                    <input
                      type="text"
                      id="quickSelectGroupInput"
                      class="form-control"
                      data-i18n="phQuickGroups"
                      placeholder="Click to select..."
                      readonly
                    />
                    <div
                      id="quickSelectGroupOptions"
                      class="options-container d-none"
                    ></div>
                  </div>
                  <button
                    type="button"
                    id="quickAdvancedGroupSelectionBtn"
                    class="btn-visual-secondary"
                    data-i18n="btnAdvSelector"
                  >
                    Advanced selector
                  </button>
                </div>
                <div
                  id="quickSelectedGroupsContainer"
                  class="selected-tags-container"
                ></div>
              </div>

              <div class="form-group mb-3">
                <div
                  class="d-flex justify-content-between align-items-center mb-1"
                >
                  <label
                    for="quick-editor-container"
                    style="font-weight: 500; font-size: 14px; margin-bottom: 0"
                    data-i18n="lblPostContent"
                    >Post Content</label
                  >
                  <div class="editor-header-controls">
                    <button
                      type="button"
                      id="toggleQuickQualityScorerBtn"
                      class="btn-visual-secondary mr-1"
                    >
                      <span data-i18n="lblPostScore">Post Score:</span>
                      <span id="quickQualityScoreBadge" class="score-badge"
                        >--</span
                      >
                    </button>
                    <button
                      type="button"
                      id="quickImportPostButton"
                      class="btn-visual-secondary"
                    >
                      <i class="fa fa-download"></i>
                      <span data-i18n="btnPreFill">Pre-fill</span>
                    </button>
                    <span
                      id="quickCharCounter"
                      class="editor-char-counter"
                      style="
                        font-size: 12px;
                        color: #6b7280;
                        background: #f3f4f6;
                        padding: 2px 6px;
                        border-radius: 4px;
                      "
                      >0 characters</span
                    >
                  </div>
                </div>
                <div
                  id="quickQualityScorerContainer"
                  class="quality-scorer-container d-none mb-3"
                ></div>
                <div
                  style="
                    border: 1px solid #d1d5db;
                    border-radius: 10px;
                    overflow: hidden;
                  "
                >
                  <div
                    id="quick-toolbar"
                    class="py-1 px-2"
                    style="
                      background-color: #fcfcff;
                      border-bottom: 1px solid #e5e7eb;
                    "
                  >
                    <span class="ql-formats">
                      <button class="ql-bold"></button>
                      <button class="ql-italic"></button>
                    </span>
                    <span class="ql-formats">
                      <button class="ql-header" value="1"></button>
                      <button class="ql-header" value="2"></button>
                    </span>
                    <span class="ql-formats">
                      <button class="ql-list" value="ordered"></button>
                      <button class="ql-list" value="bullet"></button>
                    </span>
                    <span class="ql-formats" style="margin-left: 0px">
                      <button
                        class="ql-emoji"
                        type="button"
                        style="
                          padding: 0px !important;
                          margin: -1px 0px 0px 0px;
                          font-size: 14px;
                        "
                        aria-label="Insert Emoji"
                      ></button>
                    </span>
                    <span class="ql-formats float-right">
                      <button
                        type="button"
                        id="quickPostSpintaxHelperBtn"
                        class="btn-visual-secondary"
                      >
                        <i class="fa fa-random"></i>
                        <span data-i18n="btnAddSpintax">Add spintax</span>
                      </button>
                    </span>
                  </div>
                  <div class="quill-container" style="height: 180px">
                    <div id="quick-editor-container"></div>
                  </div>
                </div>
              </div>

              <div class="form-group mb-4">
                <!-- Existing AI Assistant Bar -->
                <div class="ai-compact-bar">
                  <div class="ai-compact-label">
                    <i class="fa fa-magic ai-compact-icon"></i>
                    <span class="ai-compact-text" data-i18n="lblAIAssistant"
                      >AI Assistant</span
                    >
                  </div>
                  <div class="ai-compact-actions">
                    <button
                      type="button"
                      id="quickAiEnhanceButton"
                      class="btn-visual-secondary btn-sm"
                      title="Enhance text"
                      data-i18n="btnEnhance"
                    >
                      Enhance text
                    </button>
                    <button
                      type="button"
                      id="quickAiGenerateButton"
                      class="btn-primary btn-sm"
                      title="Generate new"
                      data-i18n="btnGenerateAI"
                    >
                      Generate new with AI
                    </button>
                  </div>
                  <div
                    id="quickAiLoadingIndicator"
                    class="ai-compact-status d-none"
                  >
                    <div class="ai-compact-spinner"></div>
                    Processing...
                  </div>
                  <div
                    id="quickAiErrorIndicator"
                    class="ai-compact-error d-none"
                  >
                    <i class="fa fa-exclamation-circle"></i>
                    <span id="quickAiErrorText">Error</span>
                  </div>
                </div>

                <!-- NEW: AI Variations Toggle (Same Width/Style) -->

                <div
                  id="quickAiVariationsContainer"
                  class="settings-panel mt-2 d-none"
                  style="
                    padding: 10px 12px;
                    border-radius: 12px;
                    border: 1px solid #e2e8f0;
                  "
                >
                  <div class="settings-option" style="padding: 0; border: none">
                    <div class="toggle-switch small-switch">
                      <input
                        type="checkbox"
                        id="quickGenerateAiVariations"
                        class="toggle-input"
                      />
                      <label
                        for="quickGenerateAiVariations"
                        class="toggle-label"
                      ></label>
                    </div>
                    <div class="option-details ml-2">
                      <span
                        class="option-name"
                        style="font-size: 13px"
                        data-i18n="lblGenAiVar"
                        >Generate AI Variations</span
                      >
                      <span
                        class="option-description"
                        style="font-size: 11px"
                        data-i18n="descGenAiVar"
                        >Create variations with different tones
                        automatically.</span
                      >
                    </div>
                  </div>

                  <div
                    id="quickAiVariationOptions"
                    class="d-none mt-2 pt-2 border-top"
                  >
                    <div class="d-flex align-items-center">
                      <label
                        for="quickAiVariationCount"
                        class="mr-2 mb-0"
                        style="font-size: 12px; color: #4b5563"
                        data-i18n="lblNumVar"
                        >Variations Count:</label
                      >
                      <input
                        type="number"
                        id="quickAiVariationCount"
                        class="form-control"
                        value="2"
                        min="1"
                        max="5"
                        style="width: 60px; height: 30px; padding: 4px 8px"
                      />
                    </div>
                  </div>
                </div>
              </div>

              <div class="form-group mb-1">
                <label
                  for="quickMediaInput"
                  class="d-flex justify-content-between align-items-center mb-1"
                >
                  <span
                    style="font-weight: 500; font-size: 14px"
                    data-i18n="lblMedia"
                    >Add Media (Optional)</span
                  >
                  <span
                    id="quickMediaCount"
                    style="
                      font-size: 12px;
                      color: #6b7280;
                      background: #f3f4f6;
                      padding: 2px 6px;
                      border-radius: 4px;
                    "
                    >0 items</span
                  >
                </label>
                <div
                  style="
                    border: 1px dashed #d1d5db;
                    border-radius: 8px;
                    padding: 12px;
                    background-color: #f7fafc;
                    text-align: center;
                    margin-bottom: 10px;
                  "
                  id="quickMediaDropzone"
                >
                  <div style="display: flex; align-items: center">
                    <button
                      style="
                        height: 60px;
                        width: 60px;
                        font-size: 24px;
                        margin-right: 4px;
                        border-radius: 8px;
                        min-width: 60px;
                        background: white;
                        border: 1px solid #d1d5db;
                        color: #6b7280;
                        display: flex;
                        align-items: center;
                        justify-content: center;
                        cursor: pointer;
                        transition: all 0.2s ease;
                      "
                      type="button"
                      id="quickInsertMediaButton"
                    >
                      <i class="fa fa-plus"></i>
                    </button>
                    <div
                      class="text-left ml-3"
                      style="text-align: left; margin-left: 12px"
                    >
                      <div
                        style="
                          font-size: 13px;
                          font-weight: 500;
                          color: #374151;
                        "
                        data-i18n="lblAddMedia"
                      >
                        Click to add images or videos
                      </div>
                      <div
                        style="font-size: 12px; color: #6b7280"
                        data-i18n="descDragDrop"
                      >
                        Drag & drop files here or click the plus button
                      </div>
                      <div
                        style="font-size: 9px; color: #6b7280"
                        data-i18n="descFormats"
                      >
                        Supported formats: Images, MP4, WebM videos
                      </div>
                    </div>
                  </div>
                </div>
                <div
                  id="quickSelectedMedia"
                  class="d-flex gap-2 flex-wrap"
                ></div>
              </div>
              <!-- Inside #quickPostPage, before the action buttons div -->

              <!-- Advanced Settings Toggle -->
              <!-- Enhanced Pause & Protection Section -->
              <div class="mb-1">
                <button
                  type="button"
                  class="btn-visual-secondary btn-sm w-100 d-flex justify-content-between align-items-center px-3 py-2"
                  data-toggle="collapse"
                  data-target="#quickPostSettings"
                  aria-expanded="false"
                  aria-controls="quickPostSettings"
                  id="toggleQuickSettingsBtn"
                  style="
                    border-radius: 8px;
                    background-color: #f8fafc;
                    border: 1px solid #e2e8f0;
                    transition: all 0.2s;
                  "
                >
                  <span class="font-weight-600 text-dark">
                    <span data-i18n="headerPause"
                      >Pause & Protection</span
                    ></span
                  >
                  <i class="fa fa-chevron-down text-muted transition-icon"></i>
                </button>
              </div>

              <div class="collapse" id="quickPostSettings">
                <div
                  class="card border-0 shadow-sm mb-4"
                  style="
                    border-radius: 12px;
                    overflow: hidden;
                    background: #fff;
                  "
                >
                  <!-- Section 1: Flow Control -->
                  <div class="p-3 border-bottom" style="background: #ffffff">
                    <div class="d-flex align-items-center mb-2">
                      <span
                        class="badge badge-light border text-uppercase"
                        style="
                          font-size: 10px;
                          letter-spacing: 0.5px;
                          color: #64748b;
                        "
                        data-i18n="lblFlowCtrl"
                        >Flow Control</span
                      >
                    </div>
                    <div class="d-flex" style="gap: 12px">
                      <!-- Interval -->
                      <div class="flex-grow-1">
                        <label
                          class="small text-muted mb-1 font-weight-500"
                          data-i18n="lblInterval"
                          >Interval</label
                        >
                        <div class="input-group input-group-sm">
                          <div class="input-group-prepend">
                            <span
                              class="input-group-text bg-light border-right-0 text-muted"
                              ><i class="fa fa-pause"></i
                            ></span>
                          </div>
                          <input
                            type="number"
                            id="quickLinkCount"
                            class="form-control border-left-0"
                            value="1"
                            min="1"
                            style="font-weight: 500"
                          />
                          <div class="input-group-append">
                            <span
                              class="input-group-text bg-light text-muted"
                              data-i18n="unitPosts"
                              >posts</span
                            >
                          </div>
                        </div>
                      </div>
                      <!-- Wait Time -->
                      <div class="flex-grow-1">
                        <label
                          class="small text-muted mb-1 font-weight-500"
                          data-i18n="lblWaitTime"
                          >Wait Time</label
                        >
                        <div class="input-group input-group-sm">
                          <div class="input-group-prepend">
                            <span
                              class="input-group-text bg-light border-right-0 text-muted"
                              ><i class="fa fa-hourglass-half"></i
                            ></span>
                          </div>
                          <input
                            type="number"
                            id="quickEnterTime"
                            class="form-control border-left-0"
                            value="2"
                            min="0"
                            step="0.1"
                            style="font-weight: 500"
                          />
                          <div class="input-group-append">
                            <span
                              class="input-group-text bg-light text-muted"
                              data-i18n="unitMin"
                              >min</span
                            >
                          </div>
                        </div>
                      </div>
                    </div>
                  </div>

                  <!-- Section 2: Security Slider -->
                  <div class="p-3 border-bottom" style="background: #fcfcfc">
                    <div
                      class="d-flex align-items-center justify-content-between mb-2"
                    >
                      <span
                        class="badge badge-light border text-uppercase"
                        style="
                          font-size: 10px;
                          letter-spacing: 0.5px;
                          color: #64748b;
                        "
                        data-i18n="lblSecLevel"
                        >Security Level</span
                      >
                      <i
                        class="fa fa-shield text-success"
                        style="font-size: 12px"
                      ></i>
                    </div>

                    <div class="mini-security-slider-wrapper">
                      <input
                        type="range"
                        id="quickSecuritySlider"
                        class="mini-security-slider"
                        min="1"
                        max="3"
                        value="3"
                        step="1"
                      />
                      <div class="mini-slider-labels mt-2">
                        <span
                          style="
                            font-size: 10px;
                            font-weight: 500;
                            color: #64748b;
                          "
                          data-i18n="lblFast"
                          >Fast</span
                        >
                        <span
                          style="
                            font-size: 10px;
                            font-weight: 500;
                            color: #64748b;
                          "
                          data-i18n="lblBalanced"
                          >Balanced</span
                        >
                        <span
                          style="
                            font-size: 10px;
                            font-weight: 600;
                            color: #10b981;
                          "
                          data-i18n="lblSafe"
                          >Safe</span
                        >
                      </div>
                    </div>
                  </div>

                  <!-- Section 3: Toggles -->
                  <div class="p-3 bg-white">
                    <div
                      class="d-flex align-items-center justify-content-between mb-2"
                    >
                      <div class="d-flex align-items-center">
                        <div class="toggle-switch small-switch mr-2">
                          <input
                            type="checkbox"
                            id="quickNightPost"
                            class="toggle-input"
                            checked
                          />
                          <label
                            for="quickNightPost"
                            class="toggle-label"
                          ></label>
                        </div>
                        <div>
                          <div
                            class="small font-weight-600 text-dark"
                            data-i18n="lblNightMode"
                          >
                            Avoid Night Posting
                          </div>
                          <div class="extra-small text-muted">
                            22:00 - 07:00
                          </div>
                        </div>
                      </div>
                      <i class="fa fa-moon-o text-muted"></i>
                    </div>

                    <div
                      class="d-flex align-items-center justify-content-between mb-2"
                    >
                      <div class="d-flex align-items-center">
                        <div class="toggle-switch small-switch mr-2">
                          <input
                            type="checkbox"
                            id="quickDelayFail"
                            class="toggle-input"
                          />
                          <label
                            for="quickDelayFail"
                            class="toggle-label"
                          ></label>
                        </div>
                        <div>
                          <div
                            class="small font-weight-600 text-dark"
                            data-i18n="lblSafeDelay"
                          >
                            Safety delay on fail
                          </div>
                          <div class="extra-small text-muted">
                            Wait even if post fails
                          </div>
                        </div>
                      </div>
                      <i class="fa fa-life-ring text-muted"></i>
                    </div>
                    <!-- NEW: Post Anonymously Toggle -->
                    <div
                      class="d-flex align-items-center justify-content-between mb-2"
                    >
                      <div class="d-flex align-items-center">
                        <div class="toggle-switch small-switch mr-2">
                          <input
                            type="checkbox"
                            id="quickPostAnonymously"
                            class="toggle-input"
                          />
                          <label
                            for="quickPostAnonymously"
                            class="toggle-label"
                          ></label>
                        </div>
                        <div>
                          <div
                            class="small font-weight-600 text-dark"
                            data-i18n="lblAnonPost"
                          >
                            Post Anonymously
                          </div>
                          <div class="extra-small text-muted">
                            If group allows it
                          </div>
                        </div>
                      </div>
                      <i class="fa fa-user-secret text-muted"></i>
                    </div>
                  </div>
                </div>
              </div>

              <!-- Collapsible Settings Panel -->
              <div class="collapse" id="quickPostSettings">
                <div class="card card-body bg-light mb-3 p-3">
                  <!-- Interval & Wait Time -->
                  <div class="d-flex mb-3" style="gap: 15px">
                    <div class="form-group mb-0" style="flex: 1">
                      <label
                        class="small text-muted mb-1"
                        data-i18n="lblInterval"
                        >Interval</label
                      >
                      <div class="input-group input-group-sm">
                        <input
                          type="number"
                          id="quickLinkCount"
                          class="form-control"
                          value="1"
                          min="1"
                        />
                        <div class="input-group-append">
                          <span class="input-group-text" data-i18n="unitPosts"
                            >posts</span
                          >
                        </div>
                      </div>
                    </div>
                    <div class="form-group mb-0" style="flex: 1">
                      <label
                        class="small text-muted mb-1"
                        data-i18n="lblWaitTime"
                        >Wait Time</label
                      >
                      <div class="input-group input-group-sm">
                        <input
                          type="number"
                          id="quickEnterTime"
                          class="form-control"
                          value="2"
                          min="0"
                          step="0.1"
                        />
                        <div class="input-group-append">
                          <span class="input-group-text" data-i18n="unitMin"
                            >min</span
                          >
                        </div>
                      </div>
                    </div>
                  </div>

                  <!-- Toggles -->
                  <div class="settings-panel compact">
                    <!-- Night Mode -->
                    <div class="settings-option py-1">
                      <div class="toggle-switch small-switch">
                        <input
                          type="checkbox"
                          id="quickNightPost"
                          class="toggle-input"
                          checked
                        />
                        <!-- Default Checked -->
                        <label
                          for="quickNightPost"
                          class="toggle-label"
                        ></label>
                      </div>
                      <div class="option-details">
                        <span class="option-name small" data-i18n="lblNightMode"
                          >Avoid night posting</span
                        >
                      </div>
                    </div>

                    <!-- Safe Delay -->
                    <div class="settings-option py-1">
                      <div class="toggle-switch small-switch">
                        <input
                          type="checkbox"
                          id="quickDelayFail"
                          class="toggle-input"
                        />
                        <label
                          for="quickDelayFail"
                          class="toggle-label"
                        ></label>
                      </div>
                      <div class="option-details">
                        <span class="option-name small" data-i18n="lblSafeDelay"
                          >Safety delay on fail</span
                        >
                      </div>
                    </div>
                  </div>
                </div>
              </div>
              <div class="d-flex mt-3" style="gap: 10px">
                <button
                  id="quickPreviewButtonFooter"
                  type="button"
                  class="btn-visual-secondary btn-sm"
                  title="Preview"
                >
                  <i class="fa fa-eye"></i>
                </button>
                <button
                  id="quickScheduleButton"
                  type="button"
                  class="btn-visual-secondary"
                  style="flex: 1"
                  disabled
                  data-i18n="btnScheduleLater"
                >
                  Schedule for Later
                </button>
                <button
                  id="quickPostButton"
                  type="button"
                  class="btn btn-primary"
                  style="flex: 1"
                  disabled
                  data-i18n="btnPostNow"
                >
                  Post Now
                </button>
              </div>
            </div>
          </div>

          <div class="info-banner mt-3">
            <i class="info-banner-icon fa fa-info-circle"></i>
            <div class="info-banner-text" data-i18n="warnQuick">
              Quick Post uses Classic posting mode & default settings.
            </div>
          </div>
        </div>

        <div id="scheduledPostsPage" class="d-none mt-3">
          <div id="missed-once-posts-container" class="d-none"></div>
          <div
            id="missed-recurring-notification-container"
            class="info-container d-none"
          ></div>

          <div>
            <div class="d-flex justify-content-between align-items-center mb-2">
              <p
                style="margin: 0px; font-weight: 600"
                data-i18n="headerScheduled"
              >
                Scheduled Posts
              </p>
              <div
                id="schedulerViewToggle"
                class="segmented-control"
                style="max-width: 220px"
              >
                <input
                  type="radio"
                  id="viewList"
                  name="schedulerView"
                  value="list"
                  checked
                />
                <label for="viewList" title="List View"
                  ><i class="fa fa-list"></i
                ></label>
                <input
                  type="radio"
                  id="viewCalendar"
                  name="schedulerView"
                  value="calendar"
                />
                <label for="viewCalendar" title="Calendar View"
                  ><i class="fa fa-calendar"></i
                ></label>
                <input
                  type="radio"
                  id="viewTimeline"
                  name="schedulerView"
                  value="timeline"
                />
                <label for="viewTimeline" title="Timeline View"
                  ><i class="fa fa-clock-o"></i
                ></label>
              </div>
            </div>

            <div id="next-post-countdown" class="mb-3 d-none"></div>

            <div
              id="filter-status-container"
              class="filter-status-container d-none"
            >
              <div
                id="calendarSelectedDate"
                class="selected-date-display"
              ></div>
              <button
                id="calendarShowAll"
                class="btn-visual-secondary"
                data-i18n="btnShowAll"
              >
                Show All Posts
              </button>
            </div>

            <div id="schedulerListView" class="card card-body">
              <div class="tab-content mt-1 mb-3">
                <div
                  class="tab-pane fade show active"
                  id="upcoming"
                  role="tabpanel"
                >
                  <div class="no-scheduled-posts text-center p-5">
                    <div class="text-secondary mb-3">
                      <i class="fa fa-calendar-o fa-3x"></i>
                    </div>
                    <h5 data-i18n="emptySched">No Scheduled Posts</h5>
                    <p class="text-muted" data-i18n="descEmptySched">
                      You haven't scheduled any posts yet.
                    </p>
                  </div>
                  <div
                    id="upcomingPostsList"
                    class="scheduled-posts-list"
                  ></div>
                </div>
              </div>
            </div>

            <div id="schedulerCalendarView" class="d-none">
              <div class="calendar-container">
                <div class="calendar-header">
                  <button id="calendarPrevMonth" class="calendar-nav-btn">
                    <i class="fa fa-chevron-left"></i>
                  </button>
                  <div id="calendarMonthYear" class="calendar-title"></div>
                  <button id="calendarNextMonth" class="calendar-nav-btn">
                    <i class="fa fa-chevron-right"></i>
                  </button>
                  <button
                    id="calendarToday"
                    class="calendar-today-btn"
                    data-i18n="lblToday"
                  >
                    Today
                  </button>
                </div>
                <div class="calendar-weekdays">
                  <div>Sun</div>
                  <div>Mon</div>
                  <div>Tue</div>
                  <div>Wed</div>
                  <div>Thu</div>
                  <div>Fri</div>
                  <div>Sat</div>
                </div>
                <div id="calendarGrid" class="calendar-grid"></div>
              </div>
            </div>

            <div id="schedulerTimelineView" class="d-none">
              <div class="timeline-container">
                <h5
                  id="timelineTitle"
                  class="timeline-title"
                  data-i18n="timelineTitle"
                >
                  Today's Schedule
                </h5>
                <div class="timeline-wrapper">
                  <div class="timeline-hours"></div>
                  <div id="timeline-events" class="timeline-events">
                    <div
                      id="timeline-now-indicator"
                      class="timeline-now-indicator"
                    >
                      <div class="now-indicator-dot"></div>
                    </div>
                  </div>
                </div>
              </div>
            </div>
            <div class="info-banner mt-2">
              <i class="info-banner-icon fa fa-info-circle"></i>
              <div class="info-banner-text" data-i18n="warnOnline">
                Your device must be online and the browser window open.
              </div>
            </div>
          </div>
        </div>

        <div id="historyPage" class="d-none mt-2">
          <div id="historyListView">
            <div class="activity-section mb-3">
              <div class="d-flex justify-content-between align-items-end mb-2">
                <span
                  class="small text-muted font-weight-bold"
                  data-i18n="lblActivity"
                  >LAST 30 DAYS ACTIVITY</span
                >
                <span class="small text-muted" id="totalPosts30Days"
                  >0 posts</span
                >
              </div>
              <div id="activityGraph" class="activity-grid"></div>
            </div>

            <div class="history-toolbar mb-3">
              <div class="search-wrapper">
                <i class="fa fa-search search-icon"></i>
                <input
                  type="text"
                  id="historySearchInput"
                  class="form-control"
                  data-i18n="phSearchHist"
                  placeholder="Search history..."
                  data-i18n="histSearch"
                />
              </div>

              <div class="toolbar-actions">
                <div
                  class="filter-wrapper"
                  title="Show only failed or skipped runs"
                >
                  <div class="toggle-switch small-switch">
                    <input
                      type="checkbox"
                      id="historyIssuesToggle"
                      class="toggle-input"
                    />
                    <label
                      for="historyIssuesToggle"
                      class="toggle-label"
                    ></label>
                  </div>
                  <span class="filter-label" data-i18n="lblIssues">Issues</span>
                </div>

                <button
                  id="checkGroupHealthBtn"
                  class="btn-visual-secondary btn-icon-text"
                  title="Scan for blocked groups"
                >
                  <i class="fa fa-user-md"></i>
                  <span data-i18n="btnHealth">Health</span>
                </button>
              </div>
            </div>

            <div class="card mb-4">
              <div class="card-body">
                <div id="historyListContainer"></div>
              </div>
            </div>
          </div>

          <div id="historyDetailView" class="d-none">
            <div class="d-flex justify-content-between align-items-center mb-2">
              <div class="d-flex align-items-center">
                <button
                  type="button"
                  class="btn-visual-secondary mr-2"
                  id="backToHistoryBtn"
                >
                  <i class="fa fa-arrow-left"></i>
                </button>
                <p
                  style="margin: 0px"
                  id="historyDetailTitle"
                  data-i18n="lblDetails"
                >
                  Posting Details
                </p>
              </div>
              <div
                class="d-flex align-items-center"
                id="historyDetailActions"
              ></div>
              <div>
                <span
                  class="badge badge-info mr-2"
                  id="historyDateBadge"
                  data-i18n="date"
                  >Date</span
                >
              </div>
            </div>

            <div class="card">
              <div class="card-body">
                <div id="historyDetailContainer"></div>
              </div>
            </div>
          </div>
        </div>

        <input
          type="file"
          class="form-ol-file d-none"
          id="quickMediaInput"
          accept="image/jpeg, image/png, image/gif, image/tiff, image/heif, image/webp, video/mp4, video/mp3, video/webm"
          multiple
        />
      </div>
      <div id="errorMsg"></div>
    </div>

    <div id="customModal" class="custom-modal-overlay d-none">
      <div class="custom-modal-container">
        <div
          class="card-header d-flex justify-content-between align-items-center"
        >
          <h5 id="customModalTitle" class="custom-modal-title-text">
            Modal Title
          </h5>
          <button
            type="button"
            id="customModalCloseBtn"
            class="custom-modal-close-icon"
            aria-label="Close"
          >
            ×
          </button>
        </div>
        <div class="custom-modal-body">
          <p id="customModalMessage">Modal message goes here.</p>
        </div>
        <div class="custom-modal-footer text-center">
          <button
            type="button"
            id="customModalCancelBtn"
            class="btn-visual-secondary d-none"
            data-i18n="btnCancel"
          >
            Cancel
          </button>
          <button type="button" id="customModalConfirmBtn" class="btn-primary">
            OK
          </button>
        </div>
      </div>
    </div>

    <div
      id="scheduleModal"
      class="modal fade"
      tabindex="-1"
      role="dialog"
      style="background-color: rgba(0, 0, 0, 0.4); padding: 20px"
    >
      <div class="modal-dialog modal-dialog-centered" role="document">
        <div class="modal-content">
          <div class="modal-header">
            <h5 class="modal-title">Schedule Your Post</h5>
            <button
              type="button"
              class="close"
              data-dismiss="modal"
              aria-label="Close"
            >
              <span aria-hidden="true">&times;</span>
            </button>
          </div>
          <div class="modal-body">
            <div class="form-group schedule-frequency-container">
              <label style="margin-bottom: 10px" data-i18n="schedFreq"
                >Posting Frequency</label
              >
              <div class="frequency-btn-group" data-toggle="buttons">
                <label class="btn btn-sm btn-outline-dark active">
                  <input
                    type="radio"
                    name="scheduleFrequency"
                    value="once"
                    checked
                  />
                  <span data-i18n="freqOnce">Once</span>
                </label>
                <label class="btn btn-outline-secondary">
                  <input type="radio" name="scheduleFrequency" value="daily" />
                  <span data-i18n="freqDaily">Daily</span>
                </label>
                <label class="btn btn-outline-secondary">
                  <input type="radio" name="scheduleFrequency" value="weekly" />
                  <span data-i18n="freqWeekly">Weekly</span>
                </label>
                <label class="btn btn-outline-secondary">
                  <input
                    type="radio"
                    name="scheduleFrequency"
                    value="monthly"
                  />
                  <span data-i18n="freqMonthly">Monthly</span>
                </label>
              </div>
            </div>

            <div class="form-group" id="onceScheduleOptions">
              <label for="scheduleDate" data-i18n="schedDate">Date</label>
              <input type="date" class="form-control mb-3" id="scheduleDate" />
              <label for="scheduleTime" data-i18n="schedTime">Time</label>
              <input type="time" class="form-control" id="scheduleTime" />
            </div>
            <div class="form-group d-none" id="dailyScheduleOptions">
              <label for="dailyTime" data-i18n="schedTime">Time</label>
              <input type="time" class="form-control" id="dailyTime" />
              <small class="form-text text-muted"
                >Posts will be published daily at this time</small
              >
            </div>

            <div class="form-group d-none" id="weeklyScheduleOptions">
              <label data-i18n="schedDaysWeek">Select Days of Week</label>
              <div
                class="btn-group-toggle d-flex flex-wrap"
                data-toggle="buttons"
              >
                <label class="btn-visual-secondary m-1 flex-fill"
                  ><input type="checkbox" name="weekday" value="1" /> Mon</label
                >
                <label class="btn-visual-secondary m-1 flex-fill"
                  ><input type="checkbox" name="weekday" value="2" /> Tue</label
                >
                <label class="btn-visual-secondary m-1 flex-fill"
                  ><input type="checkbox" name="weekday" value="3" /> Wed</label
                >
                <label class="btn-visual-secondary m-1 flex-fill"
                  ><input type="checkbox" name="weekday" value="4" /> Thu</label
                >
                <label class="btn-visual-secondary m-1 flex-fill"
                  ><input type="checkbox" name="weekday" value="5" /> Fri</label
                >
                <label class="btn-visual-secondary m-1 flex-fill"
                  ><input type="checkbox" name="weekday" value="6" /> Sat</label
                >
                <label class="btn-visual-secondary m-1 flex-fill"
                  ><input type="checkbox" name="weekday" value="0" /> Sun</label
                >
              </div>
              <div class="mt-3">
                <label for="weeklyTime" data-i18n="schedTime">Time</label
                ><input type="time" class="form-control" id="weeklyTime" />
              </div>
            </div>

            <!-- popup.html -->
            <div class="form-group d-none" id="monthlyScheduleOptions">
              <label data-i18n="schedDaysMonth">Select Days of Month</label>
              <div class="d-flex flex-wrap">
                <!-- Added ID 'monthDayContainer' and removed hardcoded buttons -->
                <div
                  id="monthDayContainer"
                  class="btn-group-toggle d-flex flex-wrap"
                  data-toggle="buttons"
                >
                  <!-- JavaScript will generate buttons 1-31 here -->
                </div>
              </div>
              <div class="mt-3">
                <label for="monthlyTime" data-i18n="schedTime">Time</label>
                <input type="time" class="form-control" id="monthlyTime" />
              </div>
            </div>
          </div>
          <div class="modal-footer">
            <button
              type="button"
              class="btn-secondary"
              data-dismiss="modal"
              data-i18n="btnCancel"
            >
              Cancel
            </button>
            <button
              type="button"
              class="btn btn-primary"
              id="saveScheduleButton"
              data-i18n="schedSave"
            >
              Save Schedule
            </button>
          </div>
        </div>
      </div>
    </div>

    <div
      class="modal fade ai-gen-elegant-modal"
      id="aiGenerateModalShared"
      tabindex="-1"
      role="dialog"
      aria-labelledby="aiGenerateModalLabelShared"
      aria-hidden="true"
      data-backdrop="static"
    >
      <div class="modal-dialog modal-dialog-centered modal-lg" role="document">
        <div class="modal-content">
          <div class="modal-header ai-gen-elegant-modal__header">
            <h5
              class="modal-title ai-gen-elegant-modal__title"
              id="aiGenerateModalLabelShared"
              data-i18n="aiModalTitle"
            >
              AI Post Generator
            </h5>
            <button
              type="button"
              class="close ai-gen-elegant-modal__close"
              data-dismiss="modal"
              aria-label="Close"
            >
              <span>×</span>
            </button>
          </div>
          <div class="modal-body ai-gen-elegant-modal__body">
            <p
              class="ai-gen-elegant-modal__subtitle"
              data-i18n="aiModalSubtitle"
            >
              Provide details below to help the AI create the best post for you.
            </p>
            <div class="form-group mb-3">
              <label
                for="aiPromptShared"
                class="ai-gen-elegant-modal__label"
                data-i18n="aiLblGoal"
                >Main Goal / Topic <span class="text-danger">*</span></label
              >
              <textarea
                class="form-control ai-gen-elegant-modal__input"
                id="aiPromptShared"
                rows="3"
                data-i18n="aiPhGoal"
                placeholder="REQUIRED: Explain the core purpose..."
                required
              ></textarea>
            </div>
            <div class="form-group">
              <div class="form-group mb-3">
                <label
                  for="aiToneShared"
                  class="ai-gen-elegant-modal__label"
                  data-i18n="aiLblTone"
                  >Desired Tone <span class="text-danger">*</span></label
                >
                <select
                  class="form-control ai-gen-elegant-modal__input"
                  id="aiToneShared"
                  style="height: 100%"
                >
                  <option value="professional" data-i18n="aiToneProf">
                    Professional
                  </option>
                  <option
                    value="friendly and engaging"
                    selected
                    data-i18n="aiToneFriendly"
                  >
                    Friendly & Engaging
                  </option>
                  <option
                    value="casual and conversational"
                    data-i18n="aiToneCasual"
                  >
                    Casual & Conversational
                  </option>
                  <option value="funny and witty" data-i18n="aiToneFunny">
                    Funny & Witty
                  </option>
                  <option
                    value="excited and enthusiastic"
                    data-i18n="aiToneExcited"
                  >
                    Excited & Enthusiastic
                  </option>
                  <option
                    value="informative and educational"
                    data-i18n="aiToneInfo"
                  >
                    Informative & Educational
                  </option>
                  <option
                    value="persuasive and sales-oriented"
                    data-i18n="aiToneSales"
                  >
                    Persuasive & Sales-Oriented
                  </option>
                  <option
                    value="inspirational and motivational"
                    data-i18n="aiToneInspire"
                  >
                    Inspirational & Motivational
                  </option>
                </select>
              </div>
              <div class="form-group mb-3">
                <label
                  for="aiTargetAudienceShared"
                  class="ai-gen-elegant-modal__label"
                  data-i18n="aiLblAudience"
                  >Target Audience <small>(Optional)</small></label
                >
                <input
                  type="text"
                  class="form-control ai-gen-elegant-modal__input"
                  id="aiTargetAudienceShared"
                  placeholder="e.g., 'Entrepreneurs'"
                  data-i18n="aiPhAudience"
                />
              </div>
            </div>
            <div class="form-group mb-3">
              <label
                for="aiKeywordsShared"
                class="ai-gen-elegant-modal__label"
                data-i18n="aiLblKeywords"
                >Key Points / Keywords <small>(Optional)</small></label
              >
              <textarea
                class="form-control ai-gen-elegant-modal__input"
                id="aiKeywordsShared"
                rows="2"
                data-i18n="aiPhKeywords"
                placeholder="List important points..."
              ></textarea>
            </div>
            <div class="form-group mb-4">
              <label
                for="aiCTAShared"
                class="ai-gen-elegant-modal__label"
                data-i18n="aiLblCTA"
                >Call to Action <small>(Optional)</small></label
              >
              <input
                type="text"
                class="form-control ai-gen-elegant-modal__input"
                id="aiCTAShared"
                data-i18n="aiPhCTA"
                placeholder="e.g., 'Visit our website'"
              />
            </div>
            <div class="form-group mt-3">
              <label
                class="mb-2 ai-gen-elegant-modal__label"
                data-i18n="aiLblOptions"
                >Additional Options</label
              >
              <div class="settings-panel ai-gen-elegant-modal__settings-panel">
                <div class="settings-option">
                  <div class="toggle-switch">
                    <input
                      class="toggle-input"
                      type="checkbox"
                      id="aiIncludeEmojisShared"
                      checked
                    />
                    <label
                      class="toggle-label"
                      for="aiIncludeEmojisShared"
                    ></label>
                  </div>
                  <div class="option-details">
                    <span class="option-name" data-i18n="aiOptEmojis"
                      >Add Emojis</span
                    >
                    <span class="option-description" data-i18n="aiOptEmojisDesc"
                      >Automatically include relevant emojis.</span
                    >
                  </div>
                </div>
                <div class="settings-option">
                  <div class="toggle-switch">
                    <input
                      class="toggle-input"
                      type="checkbox"
                      id="aiUseSpintaxShared"
                    />
                    <label
                      class="toggle-label"
                      for="aiUseSpintaxShared"
                    ></label>
                  </div>
                  <div class="option-details">
                    <span class="option-name" data-i18n="aiUseSpintax"
                      >Use Spintax</span
                    >
                    <span
                      class="option-description"
                      data-i18n="aiOptSpintaxDesc"
                      >Generate text variations like {A|B}.</span
                    >
                  </div>
                </div>
                <div class="settings-option">
                  <div class="toggle-switch">
                    <input
                      class="toggle-input"
                      type="checkbox"
                      id="aiIncludeHashtagsShared"
                    />
                    <label
                      class="toggle-label"
                      for="aiIncludeHashtagsShared"
                    ></label>
                  </div>
                  <div class="option-details">
                    <span class="option-name" data-i18n="aiOptHashtags"
                      >Add Hashtags</span
                    >
                    <span
                      class="option-description"
                      data-i18n="aiOptHashtagsDesc"
                      >Include relevant #hashtags at the end.</span
                    >
                  </div>
                </div>
              </div>
            </div>
          </div>
          <div class="modal-footer ai-gen-elegant-modal__footer">
            <button
              type="button"
              class="btn-visual-secondary"
              data-dismiss="modal"
              data-i18n="btnCancel"
            >
              Cancel
            </button>
            <button
              type="button"
              class="btn btn-primary"
              id="submitAiGenerateShared"
              data-i18n="aiBtnGenerate"
            >
              Generate Post
            </button>
          </div>
        </div>
      </div>
    </div>

    <div id="elegantRatingModal" class="elegant-modal-overlay d-none">
      <div class="elegant-modal-container">
        <button
          type="button"
          id="closeElegantModalBtn"
          class="elegant-modal-close"
        >
          ×
        </button>
        <div id="ratingContentSection">
          <div class="elegant-modal-icon">
            <svg
              xmlns="http://www.w3.org/2000/svg"
              fill="none"
              viewBox="0 0 24 24"
              stroke-width="1.5"
              stroke="currentColor"
            >
              <path
                stroke-linecap="round"
                stroke-linejoin="round"
                d="M11.48 3.499a.562.562 0 0 1 1.04 0l2.125 5.111a.563.563 0 0 0 .475.31h5.518a.563.563 0 0 1 .328.971l-4.204 3.602a.563.563 0 0 0-.183.557l1.536 4.98a.562.562 0 0 1-.844.622l-4.21-3.422a.563.563 0 0 0-.664 0l-4.21 3.422a.562.562 0 0 1-.844-.622l1.536-4.98a.563.563 0 0 0-.183-.557l-4.204-3.602a.563.563 0 0 1 .328-.971h5.518a.563.563 0 0 0 .475-.31L11.48 3.5Z"
              />
            </svg>
          </div>
          <h4 class="elegant-modal-title" data-i18n="rateTitle">
            How are we doing?
          </h4>
          <p class="elegant-modal-text" data-i18n="rateText">
            How has your experience been?
          </p>
          <div id="elegantStarRatingContainer" class="elegant-star-rating">
            <span class="elegant-star" data-value="1">☆</span>
            <span class="elegant-star" data-value="2">☆</span>
            <span class="elegant-star" data-value="3">☆</span>
            <span class="elegant-star" data-value="4">☆</span>
            <span class="elegant-star" data-value="5">☆</span>
          </div>
          <input type="hidden" id="elegantHiddenRatingValue" value="0" />
          <div id="elegantRatingError" class="elegant-rating-error d-none">
            Please select a rating.
          </div>
          <div class="elegant-modal-actions">
            <button
              id="elegantMaybeLaterBtn"
              class="btn-visual-secondary"
              data-i18n="rateBtnLater"
            >
              Maybe Later
            </button>
            <button
              id="elegantSubmitRatingBtn"
              class="btn-primary"
              data-i18n="rateBtnSubmit"
              disabled
            >
              Submit Rating
            </button>
          </div>
        </div>

        <div id="feedbackRequestSection" class="d-none">
          <div
            class="elegant-modal-icon"
            style="background-color: #fffbeb; color: #f59e0b"
          >
            <svg
              xmlns="http://www.w3.org/2000/svg"
              fill="none"
              viewBox="0 0 24 24"
              stroke-width="1.5"
              stroke="currentColor"
              class="w-6 h-6"
            >
              <path
                stroke-linecap="round"
                stroke-linejoin="round"
                d="M12 9v3.75m-9.303 3.376c-.866 1.5.217 3.374 1.948 3.374h14.71c1.73 0 2.813-1.874 1.948-3.374L13.949 3.378c-.866-1.5-3.032-1.5-3.898 0L2.697 16.126ZM12 15.75h.007v.008H12v-.008Z"
              />
            </svg>
          </div>
          <h4 class="elegant-modal-title">Thanks for your honesty!</h4>
          <p class="elegant-modal-text">
            We're sorry! How can we improve?
            <span
              id="feedbackRewardText"
              class="d-none"
              style="display: block; margin-top: 8px"
              >As a thank you, we'll add 3 more free posts!</span
            >
          </p>
          <div
            class="elegant-modal-actions"
            style="flex-direction: column; gap: 10px"
          >
            <a
              href="#"
              target="_blank"
              id="goToFeedbackFormBtn"
              class="btn-primary"
              style="text-decoration: none"
              >Give Feedback & Get Posts</a
            >
            <button id="noThanksFeedbackBtn" class="btn-visual-secondary">
              No Thanks
            </button>
          </div>
        </div>

        <div id="publicReviewRequestSection" class="d-none">
          <div
            class="elegant-modal-icon"
            style="background-color: #dcfce7; color: #16a34a"
          >
            <svg
              xmlns="http://www.w3.org/2000/svg"
              fill="none"
              viewBox="0 0 24 24"
              stroke-width="1.5"
              stroke="currentColor"
            >
              <path
                stroke-linecap="round"
                stroke-linejoin="round"
                d="M9 12.75 11.25 15 15 9.75M21 12a9 9 0 1 1-18 0 9 9 0 0 1 18 0Z"
              />
            </svg>
          </div>
          <h4 class="elegant-modal-title">Awesome!</h4>
          <p class="elegant-modal-text">
            Would you mind leaving a quick review?
            <span
              id="publicReviewRewardText"
              class="d-none"
              style="display: block; margin-top: 8px"
              >As a thank you, we'll add 3 more free posts!</span
            >
          </p>
          <div
            class="elegant-modal-actions"
            style="flex-direction: column; gap: 10px"
          >
            <a
              href="#"
              target="_blank"
              id="goToStoreAndGetPostsBtn"
              class="btn-primary"
              style="text-decoration: none"
              >Rate on Store & Get Posts</a
            >
            <button id="maybeLaterPublicBtn" class="btn-visual-secondary">
              No Thanks
            </button>
          </div>
        </div>
      </div>
    </div>

    <template id="scheduledPostTemplate">
      <div class="scheduled-post-item card mb-3">
        <div class="card-body">
          <div class="d-flex justify-content-between align-items-start">
            <div>
              <h6 class="card-title post-title mb-1">Post Title</h6>
              <p class="card-text text-muted mb-1 small next-schedule-date">
                Status: Loading...
              </p>
              <div class="small text-muted">
                <span class="frequency-badge badge mr-2">Freq</span>
                <span class="groups-count mr-2">X groups</span>
                <span class="schedule-details">Details...</span>
              </div>
              <div class="post-error small text-danger mt-1 d-none"></div>
            </div>
            <div class="group-actions">
              <button
                type="button"
                class="group-btn run-now btnRunNow"
                title="Run Now"
              >
                <svg
                  viewBox="0 0 24 24"
                  fill="none"
                  stroke="currentColor"
                  stroke-width="2"
                >
                  <polygon points="5 3 19 12 5 21 5 3"></polygon>
                </svg>
              </button>
              <button
                type="button"
                class="group-btn edit btnEditGroup edit-schedule-btn"
                title="Edit"
              >
                <svg
                  viewBox="0 0 24 24"
                  fill="none"
                  stroke="currentColor"
                  stroke-width="2"
                >
                  <path
                    d="M11 4H4a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7"
                  ></path>
                  <path
                    d="M18.5 2.5a2.121 2.121 0 0 1 3 3L12 15l-4 1 1-4 9.5-9.5z"
                  ></path>
                </svg>
              </button>
              <button
                type="button"
                class="group-btn delete btnRemoveGroup delete-schedule-btn"
                title="Delete"
              >
                <svg
                  viewBox="0 0 24 24"
                  fill="none"
                  stroke="currentColor"
                  stroke-width="2"
                >
                  <path d="M3 6h18"></path>
                  <path d="M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6"></path>
                  <path d="M8 6V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2"></path>
                </svg>
              </button>
            </div>
          </div>
        </div>
      </div>
    </template>

    <!-- TUTORIAL MODAL (Localized) -->
    <div id="tut-modal-overlay" class="tut-modal-overlay d-none">
      <div class="tut-modal-container">
        <button
          type="button"
          id="tut-modal-close"
          class="tut-modal-close"
          title="Skip"
        >
          ×
        </button>

        <!-- STEP 1: Welcome -->
        <div class="tut-step tut-step-visible" data-step="1">
          <div class="tut-step-icon tut-step-icon-1">
            <i class="fa fa-hand-peace-o" style="font-size: 30px"></i>
          </div>
          <h4 class="tut-step-title" data-i18n="tour1Title">
            Welcome to Auto Poster!
          </h4>
          <p class="tut-step-text" data-i18n="tour1Text">
            The safest, most powerful way to automate your Facebook group
            outreach. Let's take a quick tour.
          </p>
          <div class="tut-step-actions">
            <button
              class="tut-btn tut-btn-primary tut-btn-next"
              data-i18n="btnStartTour"
            >
              Start Tour
            </button>
          </div>
        </div>

        <!-- STEP 2: Templates -->
        <div class="tut-step" data-step="2">
          <div class="tut-step-icon tut-step-icon-2">
            <i class="fa fa-file-text-o" style="font-size: 30px"></i>
          </div>
          <h4 class="tut-step-title" data-i18n="tour2Title">
            1. Create Templates
          </h4>
          <p class="tut-step-text" data-i18n="tour2Text">
            Start here. Create reusable <strong>Post Templates</strong> and
            organize your target groups into <strong>Collections</strong>.
          </p>
          <div class="tut-step-actions">
            <button
              class="tut-btn tut-btn-secondary tut-btn-prev"
              data-i18n="btnBack"
            >
              Back
            </button>
            <button
              class="tut-btn tut-btn-primary tut-btn-next"
              data-i18n="btnNext"
            >
              Next
            </button>
          </div>
        </div>

        <!-- STEP 3: Compose -->
        <div class="tut-step" data-step="3">
          <div class="tut-step-icon tut-step-icon-3">
            <i class="fa fa-pencil-square-o" style="font-size: 30px"></i>
          </div>
          <h4 class="tut-step-title" data-i18n="tour3Title">
            2. Compose & Schedule
          </h4>
          <p class="tut-step-text" data-i18n="tour3Text">
            Use <strong>Simple Post</strong> for quick blasts, or the
            <strong>Advanced Scheduler</strong> to plan posts ahead.
          </p>
          <div class="tut-step-actions">
            <button
              class="tut-btn tut-btn-secondary tut-btn-prev"
              data-i18n="btnBack"
            >
              Back
            </button>
            <button
              class="tut-btn tut-btn-primary tut-btn-next"
              data-i18n="btnNext"
            >
              Next
            </button>
          </div>
        </div>

        <!-- STEP 4: Campaigns -->
        <div class="tut-step" data-step="4">
          <div class="tut-step-icon tut-step-icon-4">
            <i class="fa fa-rocket" style="font-size: 30px"></i>
          </div>
          <h4 class="tut-step-title" data-i18n="tour4Title">
            3. Automated Campaigns
          </h4>
          <p class="tut-step-text" data-i18n="tour4Text">
            Build powerful workflows. Chain multiple posts, set specific delays,
            and loop your strategy.
          </p>
          <div class="tut-step-actions">
            <button
              class="tut-btn tut-btn-secondary tut-btn-prev"
              data-i18n="btnBack"
            >
              Back
            </button>
            <button
              class="tut-btn tut-btn-primary tut-btn-next"
              data-i18n="btnNext"
            >
              Next
            </button>
          </div>
        </div>

        <!-- STEP 5: History -->
        <div class="tut-step" data-step="5">
          <div class="tut-step-icon tut-step-icon-5">
            <i class="fa fa-history" style="font-size: 30px"></i>
          </div>
          <h4 class="tut-step-title" data-i18n="tour5Title">
            4. Track History
          </h4>
          <p class="tut-step-text" data-i18n="tour5Text">
            View logs of every run. See what succeeded or failed, and retry with
            one click.
          </p>
          <div class="tut-step-actions">
            <button
              class="tut-btn tut-btn-secondary tut-btn-prev"
              data-i18n="btnBack"
            >
              Back
            </button>
            <button
              class="tut-btn tut-btn-primary tut-btn-next"
              data-i18n="btnNext"
            >
              Next
            </button>
          </div>
        </div>

        <!-- STEP 6: Finish -->
        <div class="tut-step" data-step="6">
          <div class="tut-step-icon tut-step-icon-1">
            <i class="fa fa-check" style="font-size: 30px"></i>
          </div>
          <h4 class="tut-step-title" data-i18n="tour6Title">You're Ready!</h4>
          <p class="tut-step-text" data-i18n="tour6Text">
            We've set up a few sample templates for you. Click below to start!
          </p>
          <div class="tut-step-actions">
            <button
              class="tut-btn tut-btn-primary tut-btn-finish"
              data-i18n="btnLetsGo"
            >
              Let's Go!
            </button>
          </div>
        </div>
      </div>
    </div>

    <div
      id="aiCampaignWizardModal"
      class="custom-modal-overlay d-none"
      style="z-index: 10000"
    >
      <div class="ai-studio-container">
        <div class="ai-studio-header">
          <div class="ai-studio-icon"><i class="fa fa-magic"></i></div>
          <div>
            <h4 class="ai-studio-title" data-i18n="modalProTitle">
              AI Campaign Architect
            </h4>
            <p class="ai-studio-subtitle" data-i18n="descGenAiVar">
              Describe your goal, upload assets, and let AI build the workflow.
            </p>
          </div>
          <button type="button" id="closeAiWizardBtn" class="ai-studio-close">
            &times;
          </button>
        </div>

        <div class="ai-studio-body">
          <div id="wizardStepInput">
            <div class="studio-section">
              <label class="studio-label"
                >Campaign Goal <span class="text-danger">*</span></label
              >
              <textarea
                id="aiWizardPrompt"
                class="studio-textarea"
                rows="2"
                placeholder="Describe your goal..."
                required
              ></textarea>
              <div class="studio-chips">
                <span
                  class="studio-chip"
                  data-prompt="Affiliate Marketing: Promote a software deal..."
                  data-i18n="campWizChip1"
                  >💰 Affiliate Deal</span
                >
                <span
                  class="studio-chip"
                  data-prompt="Real Estate: Showcase a new property..."
                  data-i18n="campWizChip2"
                  >🏠 Real Estate</span
                >
                <span
                  class="studio-chip"
                  data-prompt="Small Biz: Launch a new menu item..."
                  data-i18n="campWizChip3"
                  >🍔 Local Biz</span
                >
              </div>
            </div>

            <div class="studio-section">
              <label class="studio-label">Content Source</label>
              <div
                class="segmented-control mb-3"
                style="width: 100%; max-width: none"
              >
                <input
                  type="radio"
                  id="sourceGenerate"
                  name="aiContentSource"
                  value="generate"
                  checked
                />
                <label for="sourceGenerate" class="segment-label-full"
                  ><i class="fa fa-pencil"></i>
                  <span data-i18n="lblSourceGen"
                    >AI Writes Everything</span
                  ></label
                >

                <input
                  type="radio"
                  id="sourceExisting"
                  name="aiContentSource"
                  value="existing"
                />
                <label for="sourceExisting" class="segment-label-full"
                  ><i class="fa fa-file-text-o"></i>
                  <span data-i18n="lblSourceExist"
                    >Use My Templates</span
                  ></label
                >
              </div>
              <div id="aiSourceGenerate">
                <p class="text-muted small mb-0">
                  <i class="fa fa-info-circle"></i>
                  <span data-i18n="descSourceGen"
                    >AI will write fresh posts.</span
                  >
                </p>
              </div>
              <div id="aiSourceExisting" class="d-none">
                <p class="text-muted small mb-2" data-i18n="descSourceExist">
                  Select your templates.
                </p>
                <div
                  class="block-multiselect-container"
                  data-type="wizard-post"
                >
                  <input
                    type="text"
                    class="block-multiselect-input"
                    placeholder="Select templates..."
                    readonly
                  />
                  <div class="block-multiselect-dropdown"></div>
                </div>
                <div class="block-selected-pills" data-type="wizard-post"></div>
              </div>
            </div>

            <div class="studio-grid">
              <div class="studio-section">
                <label class="studio-label">Target Audience</label>
                <div class="group-select-row">
                  <div
                    class="block-multiselect-container"
                    data-type="wizard-group"
                  >
                    <input
                      type="text"
                      class="block-multiselect-input"
                      placeholder="Select collections..."
                      readonly
                    />
                    <div class="block-multiselect-dropdown"></div>
                  </div>
                  <button
                    class="btn btn-visual-secondary advanced-target-btn"
                    id="aiWizardAdvancedGroupBtn"
                    title="Advanced Selector"
                  >
                    Advanced
                  </button>
                </div>
                <div
                  class="block-selected-pills"
                  data-type="wizard-group"
                ></div>
                <div class="settings-option mt-3">
                  <div class="toggle-switch">
                    <input
                      type="checkbox"
                      class="toggle-input"
                      id="aiWizardSmartGroup"
                    />
                    <label
                      class="toggle-label"
                      for="aiWizardSmartGroup"
                    ></label>
                  </div>
                  <div class="option-details">
                    <span class="option-name" data-i18n="lblAutoMatch"
                      >Auto-match Groups</span
                    >
                  </div>
                </div>
              </div>

              <div class="studio-section">
                <label class="studio-label">Automation Settings</label>
                <div class="settings-option">
                  <div class="toggle-switch">
                    <input
                      type="checkbox"
                      class="toggle-input"
                      id="aiWizardLoop"
                    />
                    <label class="toggle-label" for="aiWizardLoop"></label>
                  </div>
                  <div class="option-details">
                    <span class="option-name" data-i18n="lblAutoLoop"
                      >Auto-Loop Forever</span
                    >
                  </div>
                </div>
                <div class="settings-option">
                  <div class="toggle-switch">
                    <input
                      type="checkbox"
                      class="toggle-input"
                      id="aiWizardImmediate"
                      checked
                    />
                    <label class="toggle-label" for="aiWizardImmediate"></label>
                  </div>
                  <div class="option-details">
                    <span class="option-name" data-i18n="lblStartImm"
                      >Start Immediately</span
                    >
                  </div>
                </div>
              </div>
            </div>

            <div class="studio-section" id="aiWizardMediaSection">
              <label class="studio-label" data-i18n="lblCampAssets"
                >Campaign Assets (Optional)</label
              >
              <div class="studio-media-dropzone" id="aiWizardDropzone">
                <i class="fa fa-cloud-upload"></i>
                <span data-i18n="lblDropFiles">Drop images/video</span>
              </div>
              <input
                type="file"
                id="aiWizardFileInput"
                multiple
                accept="image/*,video/*"
                class="d-none"
              />
              <div id="aiWizardMediaPreview" class="studio-media-preview"></div>
            </div>
          </div>

          <div id="wizardStepLoading" class="d-none text-center py-5">
            <div class="ai-studio-loader">
              <div class="orb"></div>
              <div class="orb"></div>
              <div class="orb"></div>
            </div>
            <h5 class="mt-4" style="color: #1e293b" data-i18n="lblConstructing">
              Constructing Strategy...
            </h5>
            <p
              class="text-muted"
              id="wizardLoadingText"
              data-i18n="lblAnalysingCopy"
            >
              Analyzing intent & generating copy...
            </p>
          </div>
        </div>

        <div class="ai-studio-footer">
          <button
            type="button"
            id="cancelAiWizardBtn"
            class="btn-studio-secondary"
            data-i18n="btnCancel"
          >
            Cancel
          </button>
          <button
            type="button"
            id="generateCampaignBtn"
            class="btn-studio-primary"
          >
            <i class="fa fa-magic"></i>
            <span data-i18n="btnGenCamp">Generate Campaign</span>
          </button>
        </div>
      </div>
    </div>

    <div
      class="modal fade ai-gen-elegant-modal fade"
      id="quickImportPostModal"
      tabindex="-1"
      role="dialog"
      aria-labelledby="quickImportPostModalLabel"
      aria-hidden="true"
    >
      <div class="modal-dialog modal-dialog-centered modal-lg" role="document">
        <div class="modal-content">
          <div class="modal-header ai-gen-elegant-modal__header">
            <h5
              class="modal-title"
              id="quickImportPostModalLabel"
              data-i18n="modalImportTitle"
            >
              Import Content
            </h5>
            <button
              type="button"
              class="close"
              data-dismiss="modal"
              aria-label="Close"
            >
              <span aria-hidden="true">×</span>
            </button>
          </div>
          <div class="modal-body ai-gen-elegant-modal__body">
            <div class="form-group">
              <label for="savedPostTemplateSelect" data-i18n="lblSelectTemp"
                >Select a Post Template:</label
              >
              <input
                type="text"
                id="quickImportSearchInput"
                class="form-control mb-2"
                data-i18n="phSearchTemp"
                data-i18n-target="placeholder"
                placeholder="Search templates..."
              />
              <div
                id="savedPostTemplateList"
                style="max-height: 300px; overflow-y: auto border-radius: .25rem;"
              >
                <p class="text-center text-muted p-3" data-i18n="lblLoadTemp">
                  Loading templates...
                </p>
              </div>
            </div>
          </div>
          <div
            class="modal-footer ai-gen-elegant-modal__footer"
            style="justify-content: start"
          >
            <button
              type="button"
              class="btn-visual-secondary"
              data-dismiss="modal"
              data-i18n="btnCancel"
            >
              Cancel
            </button>
          </div>
        </div>
      </div>
    </div>

    <div id="spintax-modal-overlay" class="spintax-modal-overlay d-none">
      <div class="spintax-modal-container">
        <div class="spintax-modal-header">
          <h5 class="spintax-modal-title" data-i18n="spinTitle">
            Create Spintax Variations
          </h5>
          <button
            type="button"
            id="spintax-modal-close"
            class="spintax-modal-close"
          >
            ×
          </button>
        </div>
        <div class="spintax-modal-body">
          <p class="spintax-modal-instructions" data-i18n="spinInstr">
            Use {option1|option2} to create variations.
          </p>
          <div id="spintax-variations-list"></div>
          <button
            type="button"
            id="spintax-add-variation-btn"
            class="btn-visual-secondary btn-block mt-3"
          >
            <i class="fa fa-plus"></i>
            <span data-i18n="spinAdd"> Another Variation</span>
          </button>
          <div class="spintax-preview-area">
            <div class="spintax-preview-header">
              <span class="spintax-preview-title" data-i18n="spinPreview"
                >Live Preview</span
              >
              <button
                type="button"
                id="spintax-shuffle-btn"
                class="btn-visual-secondary"
                title="Shuffle"
              >
                <i class="fa fa-random"></i>
                <span data-i18n="spinShuffle">Shuffle</span>
              </button>
            </div>
            <div
              id="spintax-preview-output"
              class="spintax-preview-output"
            ></div>
            <div class="spintax-modal-footer">
              <button
                type="button"
                id="spintax-modal-cancel-btn"
                class="btn-visual-secondary"
                data-i18n="btnCancel"
              >
                Cancel
              </button>
              <button
                type="button"
                id="spintax-modal-apply-btn"
                class="btn btn-primary"
                data-i18n="btnAddSpintax"
                data-i18n="spinApply"
              >
                Add Spintax
              </button>
            </div>
          </div>
        </div>
      </div>
    </div>

    <div id="categoryManagementModal" class="custom-modal-overlay d-none">
      <div class="custom-modal-container" style="max-width: 420px">
        <div class="custom-modal-header">
          <h5 class="custom-modal-title-text" data-i18n="modalCategoryTitle">
            Manage Categories
          </h5>
          <button
            type="button"
            id="categoryModalCloseBtn"
            class="custom-modal-close-icon"
          >
            ×
          </button>
        </div>
        <div class="custom-modal-body">
          <div id="categoryListContainer" class="mb-3">
            <p class="text-center text-muted">No categories created yet.</p>
          </div>
          <div id="addCategoryForm">
            <label
              class="form-label"
              style="font-weight: 500"
              data-i18n="catAdd"
              >Add New Category</label
            >
            <div class="input-group">
              <input
                type="text"
                id="newCategoryName"
                class="form-control"
                placeholder="Category Name"
                maxlength="25"
              />
              <div class="input-group-append">
                <button
                  class="btn-visual-secondary ml-3"
                  id="addNewCategoryBtn"
                  type="button"
                  data-i18n="btnAdd"
                >
                  Add
                </button>
              </div>
            </div>
          </div>
        </div>
        <div class="custom-modal-footer">
          <button
            type="button"
            id="categoryModalDoneBtn"
            class="btn-visual-secondary"
            data-i18n="btnDone"
          >
            Done
          </button>
        </div>
      </div>
    </div>

    <div
      id="postTargeterModal"
      class="custom-modal-overlay d-none"
      style="z-index: 99999990"
    >
      <div class="custom-modal-container" style="max-width: 520px">
        <div class="custom-modal-header">
          <h5 class="custom-modal-title-text" data-i18n="modalTargetTitle">
            Advanced Group Selection
          </h5>
          <button
            type="button"
            id="postTargeterCloseBtn"
            class="custom-modal-close-icon"
          >
            ×
          </button>
        </div>
        <div
          class="custom-modal-body"
          style="
            padding: 1.25rem 1.25rem 0.5rem 1.25rem;
            background-color: #f9fafb;
          "
        >
          <div class="form-group mb-3">
            <label
              class="form-label"
              style="font-weight: 500"
              data-i18n="targeterStep1"
              >1. Select Group Collections</label
            >
            <div
              id="targeterCollectionList"
              class="card"
              style="max-height: 250px; overflow-y: auto"
            >
              <div class="list-group list-group-flush">
                <p class="text-center text-muted p-3">Loading collections...</p>
              </div>
            </div>
          </div>

          <div class="form-group mb-3">
            <label
              for="targeterIndividualSearch"
              class="form-label"
              data-i18n="targeterStep2"
              style="font-weight: 500"
              >2. (Optional) Add Specific Groups</label
            >
            <div class="position-relative">
              <input
                type="text"
                class="form-control"
                data-i18n="targeterPhSearch"
                id="targeterIndividualSearch"
                placeholder="Search across all your groups..."
              />
              <div
                id="targeterSearchResults"
                class="options-container d-none"
                style="border-radius: 8px; margin-top: 2px"
              ></div>
            </div>
            <div
              id="targeterSelectedIndividuals"
              class="selected-tags-container mt-2"
            ></div>
          </div>

          <div
            id="targeterConfigSection"
            class="form-group mb-2 p-3"
            style="
              background-color: #ffffff;
              border-radius: 8px;
              border: 1px solid #f1f5f9;
            "
          >
            <label
              class="form-label"
              style="font-weight: 500"
              data-i18n="targeterStep3"
              >3. Configure Posting Strategy</label
            >
            <p
              id="targeterSummaryText"
              class="text-muted small mb-2"
              data-i18n="targeterSummaryInit"
            >
              Select collections or groups to see options.
            </p>

            <div id="targeterModeContainer" class="d-none">
              <div class="segmented-control mb-3">
                <input
                  type="radio"
                  id="targetModeAll"
                  name="targetingMode"
                  value="all"
                  checked
                />
                <label for="targetModeAll" data-i18n="targeterModeAll"
                  >Post to All Selected</label
                >
                <input
                  type="radio"
                  id="targetModeRandom"
                  name="targetingMode"
                  value="random"
                />
                <label for="targetModeRandom" data-i18n="targeterModeRandom"
                  >Random Subset</label
                >
              </div>

              <div id="targeterRandomOptions" class="d-none">
                <div class="input-group mb-3">
                  <div class="input-group-prepend">
                    <span
                      class="input-group-text"
                      data-i18n="targeterInputPostTo"
                      >Post to</span
                    >
                  </div>
                  <input
                    type="number"
                    id="targeterRandomCount"
                    class="form-control"
                    value="10"
                    min="1"
                  />
                  <div class="input-group-append">
                    <span
                      class="input-group-text"
                      data-i18n="targeterInputRandom"
                      >random groups</span
                    >
                  </div>
                </div>

                <div
                  class="settings-option"
                  style="
                    border-top: 1px solid #e5e7eb;
                    padding-top: 12px;
                    margin-top: 8px;
                  "
                >
                  <div class="toggle-switch">
                    <input
                      type="checkbox"
                      id="prioritizeFreshToggle"
                      class="toggle-input"
                    />
                    <label
                      for="prioritizeFreshToggle"
                      class="toggle-label"
                    ></label>
                  </div>
                  <div class="option-details">
                    <span
                      class="option-name"
                      style="font-size: 13px"
                      data-i18n="targeterToggleFresh"
                      >Prioritize Fresh Groups</span
                    >
                    <span
                      class="option-description"
                      data-i18n="targeterDescFresh"
                      >Select groups you haven't posted to recently first.</span
                    >
                  </div>
                </div>
              </div>
            </div>
          </div>
        </div>
        <div class="custom-modal-footer">
          <button
            type="button"
            id="postTargeterCancelBtn"
            class="btn-visual-secondary"
            data-i18n="btnCancel"
          >
            Cancel
          </button>
          <button
            type="button"
            id="postTargeterConfirmBtn"
            class="btn btn-primary"
            disabled
            data-i18n="modalTargetConfirm"
          >
            Confirm Selection
          </button>
        </div>
      </div>
    </div>
    <script src="popup.js"></script>
    <script src="js/quill.js"></script>
    <script src="js/emoji-button-3.0.3.min.js"></script>
  </body>
</html>
